
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recommender algorithms module &#8212; &lt;h1 style=&#34;font-size:2em;text-align:center;color:#FF5733&#34;&gt;Recommenders&lt;/h1&gt;</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title"><h1 style="font-size:2em;text-align:center;color:#FF5733">Recommenders</h1></h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Getting Started Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../examples/00_quick_start/als_movielens.html">
   Running ALS on MovieLens (PySpark)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../examples/00_quick_start/ncf_movielens.html">
   Neural Collaborative Filtering on MovieLens dataset.
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/source/models.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/microsoft/genalog"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/microsoft/genalog/issues/new?title=Issue%20on%20page%20%2Fsource/models.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.cornac.cornac_utils">
   Cornac
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deeprec">
   DeepRec
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.base_model">
     Base model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.dkn">
     DKN
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.dkn_item2item">
     DKN item-to-item
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.graphrec.lightgcn">
     LightGCN
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.xDeepFM">
     xDeepFM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sequential-models">
     Sequential models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sequential_base_model">
       Sequential base model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.asvd">
       A2SVD
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.caser">
       Caser
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.gru4rec">
       GRU4Rec
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.nextitnet">
       NextItNet
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.rnn_cell_implement">
       RNN Cells
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sum">
       SUM
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.models.sequential.sli_rec">
       SLIRec
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.io.iterator">
     Iterators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF">
     Data processing utilities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-recommenders.models.deeprec.deeprec_utils">
     Utilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.fastai.fastai_utils">
   FastAI
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.geoimc.geoimc_algorithm">
   GeoIMC
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.lightfm.lightfm_utils">
   LightFM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.lightgbm.lightgbm_utils">
   LightGBM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.ncf.dataset">
   NCF
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.newsrec.io.mind_all_iterator">
   NewsRec
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.rbm.rbm">
   RBM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.rlrmc.RLRMCalgorithm">
   RLRMC
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.sar.sar_singlenode">
   SAR
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.surprise.surprise_utils">
   Surprise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.tfidf.tfidf_utils">
   TF-IDF
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.vae.multinomial_vae">
   VAE
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-recommenders.models.wide_deep.wide_deep_utils">
   Wide &amp; Deep
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="recommender-algorithms-module">
<span id="recommender"></span><h1>Recommender algorithms module<a class="headerlink" href="#recommender-algorithms-module" title="Permalink to this headline">¶</a></h1>
<p>Recommender system algorithms and utilities.</p>
<div class="section" id="module-recommenders.models.cornac.cornac_utils">
<span id="cornac"></span><h2>Cornac<a class="headerlink" href="#module-recommenders.models.cornac.cornac_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.cornac.cornac_utils.predict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.cornac_utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/cornac/cornac_utils.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.cornac_utils.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predictions of a recommender model from Cornac on the data.
Can be used for computing rating metrics like RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>cornac.models.Recommender</em>) – A recommender model from Cornac</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data on which to predict</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – Name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – Name of the item column</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.cornac.cornac_utils.predict_ranking">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.cornac.cornac_utils.</span></span><span class="sig-name descname"><span class="pre">predict_ranking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/cornac/cornac_utils.html#predict_ranking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.cornac.cornac_utils.predict_ranking" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predictions of recommender model from Cornac on all users and items in data.
It can be used for computing ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>cornac.models.Recommender</em>) – A recommender model from Cornac</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The data from which to get the users and items</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – Name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – Name of the item column</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove (user, item) pairs seen in the training data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="deeprec">
<h2>DeepRec<a class="headerlink" href="#deeprec" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-recommenders.models.deeprec.models.base_model">
<span id="base-model"></span><h3>Base model<a class="headerlink" href="#module-recommenders.models.deeprec.models.base_model" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for models</p>
<p>Initializing the model. Create common logics which are needed by all deeprec models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the data in <cite>feed_dict</cite> with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of evaluated results, including total loss value, data loss value, predicted scores, and ground-truth labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model with <cite>train_file</cite>. Evaluate the model on valid_file per epoch to observe the training status.
If <cite>test_file</cite> is not None, evaluate it too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – training data set.</p></li>
<li><p><strong>valid_file</strong> (<em>str</em>) – validation set.</p></li>
<li><p><strong>test_file</strong> (<em>str</em>) – test set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.group_labels">
<span class="sig-name descname"><span class="pre">group_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.group_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.group_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Devide <cite>labels</cite> and <cite>preds</cite> into several group according to values in group keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – ground truth label list.</p></li>
<li><p><strong>preds</strong> (<em>list</em>) – prediction score list.</p></li>
<li><p><strong>group_keys</strong> (<em>list</em>) – group key list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Labels after group.</p></li>
<li><p>Predictions after group.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.infer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.infer" title="Permalink to this definition">¶</a></dt>
<dd><p>Given feature data (in <cite>feed_dict</cite>), get predicted scores with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Instances to predict. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Predicted scores for the given instances.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an existing model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> – model path.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>IOError</strong> – if the restore operation failed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make predictions on the given data, and output predicted scores to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile_name</strong> (<em>str</em>) – Input file name, format is same as train/val/test file.</p></li>
<li><p><strong>outfile_name</strong> (<em>str</em>) – Output file name, each line is the predict score.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.run_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that contains evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.base_model.BaseModel.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/base_model.html#BaseModel.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.base_model.BaseModel.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Go through the optimization step once with training data in <cite>feed_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values to train the model. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of values, including update operation, total loss, data loss, and merged summary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.dkn">
<span id="dkn"></span><h3>DKN<a class="headerlink" href="#module-recommenders.models.deeprec.models.dkn" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.dkn.</span></span><span class="sig-name descname"><span class="pre">DKN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/dkn.html#DKN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN" title="Permalink to this definition">¶</a></dt>
<dd><p>DKN model (Deep Knowledge-Aware Network)</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>H. Wang, F. Zhang, X. Xie and M. Guo, “DKN: Deep Knowledge-Aware Network for News
Recommendation”, in Proceedings of the 2018 World Wide Web Conference on World
Wide Web, 2018.</p>
</dd>
</dl>
<p>Initialization steps for DKN.
Compared with the BaseModel, DKN requires two different pre-computed embeddings,
i.e. word embedding and entity embedding.
After creating these two embedding variables, BaseModel’s <cite>__init__</cite> method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – DKN data loader class.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN.infer_embedding">
<span class="sig-name descname"><span class="pre">infer_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/dkn.html#DKN.infer_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN.infer_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer document embedding in feed_dict with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>News embedding in a batch.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn.DKN.run_get_embedding">
<span class="sig-name descname"><span class="pre">run_get_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/dkn.html#DKN.run_get_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn.DKN.run_get_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>infer document embedding with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile_name</strong> (<em>str</em>) – Input file name, format is [Newsid] [w1,w2,w3…] [e1,e2,e3…]</p></li>
<li><p><strong>outfile_name</strong> (<em>str</em>) – Output file name, format is [Newsid] [embedding]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.dkn_item2item">
<span id="dkn-item-to-item"></span><h3>DKN item-to-item<a class="headerlink" href="#module-recommenders.models.deeprec.models.dkn_item2item" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.dkn_item2item.</span></span><span class="sig-name descname"><span class="pre">DKNItem2Item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/dkn_item2item.html#DKNItem2Item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for item-to-item recommendations using DKN.
See <a class="reference external" href="https://github.com/microsoft/recommenders/blob/main/examples/07_tutorials/KDD2020-tutorial/step4_run_dkn_item2item.ipynb">https://github.com/microsoft/recommenders/blob/main/examples/07_tutorials/KDD2020-tutorial/step4_run_dkn_item2item.ipynb</a></p>
<p>Initialization steps for DKN.
Compared with the BaseModel, DKN requires two different pre-computed embeddings,
i.e. word embedding and entity embedding.
After creating these two embedding variables, BaseModel’s <cite>__init__</cite> method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – DKN data loader class.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/dkn_item2item.html#DKNItem2Item.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the data in <cite>feed_dict</cite> with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple with predictions and labels arrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/dkn_item2item.html#DKNItem2Item.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.dkn_item2item.DKNItem2Item.run_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.graphrec.lightgcn">
<span id="lightgcn"></span><h3>LightGCN<a class="headerlink" href="#module-recommenders.models.deeprec.models.graphrec.lightgcn" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.graphrec.lightgcn.</span></span><span class="sig-name descname"><span class="pre">LightGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>LightGCN model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>He, Xiangnan, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang.
“LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation.” arXiv
preprint arXiv:2002.02126, 2020.</p>
</dd>
</dl>
<p>Initializing the model. Create parameters, placeholders, embeddings and loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A tf.contrib.training.HParams object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>data</strong> (<em>object</em>) – A recommenders.models.deeprec.DataModel.ImplicitCF object, load and process data.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model on self.data.train. If eval_epoch is not -1, evaluate the model on <cite>self.data.test</cite>
every <cite>eval_epoch</cite> epoch to observe the training status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.infer_embedding">
<span class="sig-name descname"><span class="pre">infer_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.infer_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.infer_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Export user and item embeddings to csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_file</strong> (<em>str</em>) – Path of file to save user embeddings.</p></li>
<li><p><strong>item_file</strong> (<em>str</em>) – Path of file to save item embeddings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an existing model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> – Model path.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>IOError</strong> – if the restore operation failed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Recommend top K items for all users in the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – Test data.</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – Number of top items to recommend.</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – Flag to sort top k results.</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove items seen in training from recommendation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Top k recommendation items for each user.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.run_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Run evaluation on self.data.test.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Results of all metrics in <cite>self.metrics</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/graphrec/lightgcn.html#LightGCN.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.graphrec.lightgcn.LightGCN.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Score all items for test users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_ids</strong> (<em>np.array</em>) – Users to test.</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – Flag to remove items seen in training from recommendation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of interest of all items for the users.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.xDeepFM">
<span id="xdeepfm"></span><h3>xDeepFM<a class="headerlink" href="#module-recommenders.models.deeprec.models.xDeepFM" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.xDeepFM.XDeepFMModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.xDeepFM.</span></span><span class="sig-name descname"><span class="pre">XDeepFMModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/xDeepFM.html#XDeepFMModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.xDeepFM.XDeepFMModel" title="Permalink to this definition">¶</a></dt>
<dd><p>xDeepFM model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>J. Lian, X. Zhou, F. Zhang, Z. Chen, X. Xie, G. Sun, “xDeepFM: Combining Explicit
and Implicit Feature Interactions for Recommender Systems”, in Proceedings of the
24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining,
KDD 2018, London, 2018.</p>
</dd>
</dl>
<p>Initializing the model. Create common logics which are needed by all deeprec models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="sequential-models">
<h3>Sequential models<a class="headerlink" href="#sequential-models" title="Permalink to this headline">¶</a></h3>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.sequential_base_model">
<span id="sequential-base-model"></span><h4>Sequential base model<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.sequential_base_model" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sequential_base_model.</span></span><span class="sig-name descname"><span class="pre">SequentialBaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for sequential models</p>
<p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_num_ngs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'group_auc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model with <cite>train_file</cite>. Evaluate the model on <cite>valid_file</cite> per epoch to observe the training status.
If <cite>test_file</cite> is not None, evaluate it too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – training data set.</p></li>
<li><p><strong>valid_file</strong> (<em>str</em>) – validation set.</p></li>
<li><p><strong>valid_num_ngs</strong> (<em>int</em>) – the number of negative instances with one positive instance in validation data.</p></li>
<li><p><strong>eval_metric</strong> (<em>str</em>) – the metric that control early stopping. e.g. “auc”, “group_auc”, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make predictions on the given data, and output predicted scores to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile_name</strong> (<em>str</em>) – Input file name.</p></li>
<li><p><strong>outfile_name</strong> (<em>str</em>) – Output file name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sequential_base_model.html#SequentialBaseModel.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sequential_base_model.SequentialBaseModel.run_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p></li>
<li><p><strong>num_ngs</strong> (<em>int</em>) – The number of negative sampling for a positive instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that contains evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.asvd">
<span id="a2svd"></span><h4>A2SVD<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.asvd" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.asvd.A2SVDModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.asvd.</span></span><span class="sig-name descname"><span class="pre">A2SVDModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/asvd.html#A2SVDModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.asvd.A2SVDModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A2SVD Model (Attentive Asynchronous Singular Value Decomposition)</p>
<p>It extends ASVD with an attention module.</p>
<dl class="field-list">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>ASVD: Y. Koren, “Factorization Meets the Neighborhood: a Multifaceted Collaborative
Filtering Model”, in Proceedings of the 14th ACM SIGKDD international conference on
Knowledge discovery and data mining, pages 426–434, ACM, 2008.</p>
<p>A2SVD: Z. Yu, J. Lian, A. Mahmoody, G. Liu and X. Xie, “Adaptive User Modeling with
Long and Short-Term Preferences for Personailzed Recommendation”, in Proceedings of
the 28th International Joint Conferences on Artificial Intelligence, IJCAI’19,
Pages 4213-4219, AAAI Press, 2019.</p>
</dd>
</dl>
<p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.caser">
<span id="caser"></span><h4>Caser<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.caser" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.caser.CaserModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.caser.</span></span><span class="sig-name descname"><span class="pre">CaserModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/caser.html#CaserModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.caser.CaserModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Caser Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>J. Tang and K. Wang, “Personalized top-n sequential recommendation via convolutional
sequence embedding”, in Proceedings of the Eleventh ACM International Conference on
Web Search and Data Mining, ACM, 2018.</p>
</dd>
</dl>
<p>Initialization of variables for caser</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A tf.contrib.training.HParams object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.gru4rec">
<span id="gru4rec"></span><h4>GRU4Rec<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.gru4rec" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.gru4rec.GRU4RecModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.gru4rec.</span></span><span class="sig-name descname"><span class="pre">GRU4RecModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/gru4rec.html#GRU4RecModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.gru4rec.GRU4RecModel" title="Permalink to this definition">¶</a></dt>
<dd><p>GRU4Rec Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>B. Hidasi, A. Karatzoglou, L. Baltrunas, D. Tikk, “Session-based Recommendations
with Recurrent Neural Networks”, ICLR (Poster), 2016.</p>
</dd>
</dl>
<p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.nextitnet">
<span id="nextitnet"></span><h4>NextItNet<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.nextitnet" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.nextitnet.NextItNetModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.nextitnet.</span></span><span class="sig-name descname"><span class="pre">NextItNetModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/nextitnet.html#NextItNetModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.nextitnet.NextItNetModel" title="Permalink to this definition">¶</a></dt>
<dd><p>NextItNet Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>Yuan, Fajie, et al. “A Simple Convolutional Generative Network
for Next Item Recommendation”, in Web Search and Data Mining, 2019.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It requires strong sequence with dataset.</p>
</div>
<p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.rnn_cell_implement">
<span id="rnn-cells"></span><h4>RNN Cells<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.rnn_cell_implement" title="Permalink to this headline">¶</a></h4>
<p>Module implementing RNN Cells.</p>
<p>This module provides a number of basic commonly used RNN cells, such as LSTM
(Long Short Term Memory) or GRU (Gated Recurrent Unit), and a number of
operators that allow adding dropouts, projections, or embeddings for inputs.
Constructing multi-layer cells is supported by the class <cite>MultiRNNCell</cite>, or by
calling the <cite>rnn</cite> ops several times.</p>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.rnn_cell_implement.</span></span><span class="sig-name descname"><span class="pre">Time4ALSTMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_peepholes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_unit_shards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proj_shards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_is_tuple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4ALSTMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4ALSTMCell.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or list/tuple of input tensors.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.output_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size of outputs produced by this cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Integer or TensorShape</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.state_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">state_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4ALSTMCell.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size(s) of state(s) used by this cell.</p>
<p>It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.rnn_cell_implement.</span></span><span class="sig-name descname"><span class="pre">Time4LSTMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_peepholes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_unit_shards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proj_shards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forget_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_is_tuple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4LSTMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/rnn_cell_implement.html#Time4LSTMCell.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or list/tuple of input tensors.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.output_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size of outputs produced by this cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Integer or TensorShape</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.state_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">state_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.rnn_cell_implement.Time4LSTMCell.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size(s) of state(s) used by this cell.</p>
<p>It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.sum">
<span id="sum"></span><h4>SUM<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.sum" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum.SUMModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sum.</span></span><span class="sig-name descname"><span class="pre">SUMModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sum.html#SUMModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum.SUMModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequential User Matrix Model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>Lian, J., Batal, I., Liu, Z., Soni, A., Kang, E. Y., Wang, Y., &amp; Xie, X.,
“Multi-Interest-Aware User Modeling for Large-Scale Sequential Recommendations”, arXiv preprint arXiv:2102.09211, 2021.</p>
</dd>
</dl>
<p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.deeprec.models.sequential.sum_cells"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMCell">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sum_cells.</span></span><span class="sig-name descname"><span class="pre">SUMCell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sum_cells.html#SUMCell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMCell" title="Permalink to this definition">¶</a></dt>
<dd><p>Cell for Sequential User Matrix</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the variables of the layer (optional, for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sum_cells.html#SUMCell.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.call" title="Permalink to this definition">¶</a></dt>
<dd><p>The real operations for SUM cell to process user behaviors.</p>
<dl class="simple">
<dt>params:</dt><dd><p>inputs: (a batch of) user behaviors at time T
state:  (a batch of) user states at time T-1</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>after process the user behavior at time T, returns (a batch of) new user states at time T</p></li>
<li><p>after process the user behavior at time T, returns (a batch of) new user states at time T</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>state, state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sum_cells.html#SUMCell.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.get_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.output_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">output_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size of outputs produced by this cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Integer or TensorShape</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.state_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">state_size</span></span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMCell.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size(s) of state(s) used by this cell.</p>
<p>It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMV2Cell">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sum_cells.</span></span><span class="sig-name descname"><span class="pre">SUMV2Cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sum_cells.html#SUMV2Cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMV2Cell" title="Permalink to this definition">¶</a></dt>
<dd><p>A variant of SUM cell, which upgrades the writing attention</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMV2Cell.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMV2Cell.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the variables of the layer (optional, for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sum_cells.SUMV2Cell.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sum_cells.html#SUMV2Cell.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sum_cells.SUMV2Cell.call" title="Permalink to this definition">¶</a></dt>
<dd><p>The real operations for SUMV2 cell to process user behaviors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – (a batch of) user behaviors at time T</p></li>
<li><p><strong>state</strong> – (a batch of) user states at time T-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>after process the user behavior at time T, returns (a batch of) new user states at time T
state: after process the user behavior at time T, returns (a batch of) new user states at time T</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>state</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.models.sequential.sli_rec">
<span id="slirec"></span><h4>SLIRec<a class="headerlink" href="#module-recommenders.models.deeprec.models.sequential.sli_rec" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.models.sequential.sli_rec.SLI_RECModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.models.sequential.sli_rec.</span></span><span class="sig-name descname"><span class="pre">SLI_RECModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/models/sequential/sli_rec.html#SLI_RECModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.models.sequential.sli_rec.SLI_RECModel" title="Permalink to this definition">¶</a></dt>
<dd><p>SLI Rec model</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>Z. Yu, J. Lian, A. Mahmoody, G. Liu and X. Xie, “Adaptive User Modeling with
Long and Short-Term Preferences for Personailzed Recommendation”, in Proceedings of
the 28th International Joint Conferences on Artificial Intelligence, IJCAI’19,
Pages 4213-4219, AAAI Press, 2019.</p>
</dd>
</dl>
<p>Initializing the model. Create common logics which are needed by all sequential models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A <cite>tf.contrib.training.HParams</cite> object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-recommenders.models.deeprec.io.iterator">
<span id="iterators"></span><h3>Iterators<a class="headerlink" href="#module-recommenders.models.deeprec.io.iterator" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.iterator.</span></span><span class="sig-name descname"><span class="pre">BaseIterator</span></span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base iterator class</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator.gen_feed_dict">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator.gen_feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method. Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary that maps string name to numpy arrays.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator.load_data_from_file">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method. Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – Text input file. Each line in this file is an instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.BaseIterator.parser_one_line">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#BaseIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.BaseIterator.parser_one_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method. Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – A string indicating one instance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.iterator.</span></span><span class="sig-name descname"><span class="pre">FFMTextIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Data loader for FFM format based models, such as xDeepFM.
Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<p>Initialize an iterator. Create the necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key settings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column splitter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID splitter in one line.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.gen_feed_dict">
<span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.gen_feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – Text input file. Each line in this file is an instance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.iterator.FFMTextIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/iterator.html#FFMTextIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.iterator.FFMTextIterator.parser_one_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – A string indicating one instance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Parsed results, including <cite>label</cite>, <cite>features</cite> and <cite>impression_id</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.deeprec.io.dkn_iterator"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.dkn_iterator.</span></span><span class="sig-name descname"><span class="pre">DKNTextIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Data loader for the DKN model.
DKN requires a special type of data format, where each instance contains a label, the candidate news article,
and user’s clicked news article. Articles are represented by title words and title entities. Words and entities
are aligned.</p>
<p>Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – the running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column spliter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID spliter in one line.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_feed_dict">
<span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – a dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_infer_feed_dict">
<span class="sig-name descname"><span class="pre">gen_infer_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.gen_infer_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.gen_infer_feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – a dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – text input file. Each line in this file is an instance.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>obj, list, int</em> –</p>
<ul class="simple">
<li><p>An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p></li>
<li><p>Impression id list.</p></li>
<li><p>Size of the data in a batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_infer_data_from_file">
<span class="sig-name descname"><span class="pre">load_infer_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.load_infer_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.load_infer_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse data from a file for infer document embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – text input file. Each line in this file is an instance.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>obj, list, int</em> –</p>
<ul class="simple">
<li><p>An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p></li>
<li><p>Impression id list.</p></li>
<li><p>Size of the data in a batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_iterator.html#DKNTextIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_iterator.DKNTextIterator.parser_one_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – a string indicating one instance</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Parsed results including <cite>label</cite>, <cite>candidate_news_index</cite>, <cite>click_news_index</cite>,
<cite>candidate_news_entity_index</cite>, <cite>click_news_entity_index</cite>, <cite>impression_id</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.deeprec.io.dkn_item2item_iterator"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.dkn_item2item_iterator.</span></span><span class="sig-name descname"><span class="pre">DKNItem2itemTextIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_item2item_iterator.html#DKNItem2itemTextIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>This new iterator is for DKN’s item-to-item recommendations version.
The tutorial can be found <a class="reference external" href="https://github.com/microsoft/recommenders/blob/main/examples/07_tutorials/KDD2020-tutorial/step4_run_dkn_item2item.ipynb">on this notebook</a>.</p>
<p>Compared with user-to-item recommendations, we don’t need the user behavior module.
So the placeholder can be simplified from the original DKNTextIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/dkn_item2item_iterator.html#DKNItem2itemTextIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.dkn_item2item_iterator.DKNItem2itemTextIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will return a mini-batch of data with features,
by looking up <cite>news_word_index</cite> dictionary and <cite>news_entity_index</cite> dictionary according to the news article’s ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>str</em>) – File path. Each line of <cite>infile</cite> is a news article’s ID.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>dict, list, int</em> –</p>
<ul class="simple">
<li><p>A dictionary that maps graph elements to numpy arrays.</p></li>
<li><p>A list with news article’s ID.</p></li>
<li><p>Size of the data in a batch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.deeprec.io.nextitnet_iterator"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.nextitnet_iterator.</span></span><span class="sig-name descname"><span class="pre">NextItNetIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/nextitnet_iterator.html#NextItNetIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.nextitnet_iterator.NextItNetIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Data loader for the NextItNet model.</p>
<p>NextItNet requires a special type of data format. In training stage, each instance will
produce <cite>(sequence_length * train_num_ngs)</cite> target items and labels, to let NextItNet
output predictions of every item in a sequence except only of the last item.</p>
<p>Initialize an iterator. Create necessary placeholders for the model.
Different from sequential iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key settings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – Column splitter in one line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.deeprec.io.sequential_iterator"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.io.sequential_iterator.</span></span><span class="sig-name descname"><span class="pre">SequentialIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key settings such as #_feature and #_field are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – The running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – Column splitter in one line.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.gen_feed_dict">
<span class="sig-name descname"><span class="pre">gen_feed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.gen_feed_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.gen_feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a dictionary that maps graph elements to values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary that maps string name to numpy arrays.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that maps graph elements to numpy arrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_num_ngs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_seq_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> (<em>str</em>) – Text input file. Each line in this file is an instance.</p></li>
<li><p><strong>batch_num_ngs</strong> (<em>int</em>) – The number of negative sampling here in batch.
0 represents that there is no need to do negative sampling here.</p></li>
<li><p><strong>min_seq_length</strong> (<em>int</em>) – The minimum number of a sequence length.
Sequences with length lower than min_seq_length will be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed results, in the format of graph <cite>feed_dict</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parse_file">
<span class="sig-name descname"><span class="pre">parse_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.parse_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parse_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the file to A list ready to be used for downstream tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_file</strong> – One of train, valid or test file which has never been parsed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list with parsing result.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/io/sequential_iterator.html#SequentialIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.io.sequential_iterator.SequentialIterator.parser_one_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – a string indicating one instance.
This string contains tab-separated values including:
label, user_hash, item_hash, item_cate, operation_time, item_history_sequence,
item_cate_history_sequence, and time_history_sequence.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Parsed results including <cite>label</cite>, <cite>user_id</cite>, <cite>item_id</cite>, <cite>item_cate</cite>, <cite>item_history_sequence</cite>, <cite>cate_history_sequence</cite>,
<cite>current_time</cite>, <cite>time_diff</cite>, <cite>time_from_first_action</cite>, <cite>time_to_now</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.DataModel.ImplicitCF">
<span id="data-processing-utilities"></span><h3>Data processing utilities<a class="headerlink" href="#module-recommenders.models.deeprec.DataModel.ImplicitCF" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.DataModel.ImplicitCF.</span></span><span class="sig-name descname"><span class="pre">ImplicitCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF" title="Permalink to this definition">¶</a></dt>
<dd><p>Data processing class for GCN models which use implicit feedback.</p>
<p>Initialize train and test set, create normalized adjacency matrix and sample data for training epochs.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adj_dir</strong> (<em>str</em>) – Directory to save / load adjacency matrices. If it is None, adjacency
matrices will be created and will not be saved.</p></li>
<li><p><strong>train</strong> (<em>pandas.DataFrame</em>) – Training data with at least columns (col_user, col_item, col_rating).</p></li>
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – Test data with at least columns (col_user, col_item, col_rating).
test can be None, if so, we only process the training data.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat">
<span class="sig-name descname"><span class="pre">create_norm_adj_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.create_norm_adj_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.create_norm_adj_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Create normalized adjacency matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Normalized adjacency matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat">
<span class="sig-name descname"><span class="pre">get_norm_adj_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.get_norm_adj_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.get_norm_adj_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Load normalized adjacency matrix if it exists, otherwise create (and save) it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Normalized adjacency matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>scipy.sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/DataModel/ImplicitCF.html#ImplicitCF.train_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.DataModel.ImplicitCF.ImplicitCF.train_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample train data every batch. One positive item and one negative item sampled for each user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>) – Batch size of users.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Sampled users.</p></li>
<li><p>Sampled positive items.</p></li>
<li><p>Sampled negative items.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.deeprec.deeprec_utils">
<span id="utilities"></span><h3>Utilities<a class="headerlink" href="#module-recommenders.models.deeprec.deeprec_utils" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.cal_metric">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">cal_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#cal_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.cal_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate metrics.</p>
<p>Available options are: <cite>auc</cite>, <cite>rmse</cite>, <cite>logloss</cite>, <cite>acc</cite> (accurary), <cite>f1</cite>, <cite>mean_mrr</cite>,
<cite>ndcg</cite> (format like: ndcg&#64;2;4;6;8), <cite>hit</cite> (format like: hit&#64;2;4;6;8), <cite>group_auc</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>array-like</em>) – Labels.</p></li>
<li><p><strong>preds</strong> (<em>array-like</em>) – Predictions.</p></li>
<li><p><strong>metrics</strong> (<em>list</em>) – List of metric names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cal_metric</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ndcg@2;4;6&quot;</span><span class="p">,</span> <span class="s2">&quot;group_auc&quot;</span><span class="p">])</span>
<span class="go">{&#39;ndcg@2&#39;: 0.4026, &#39;ndcg@4&#39;: 0.4953, &#39;ndcg@6&#39;: 0.5346, &#39;group_auc&#39;: 0.8096}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.check_nn_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">check_nn_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#check_nn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.check_nn_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Check neural networks configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f_config</strong> (<em>dict</em>) – Neural network configuration.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the parameters are not correct.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.check_type">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">check_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#check_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.check_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the config parameters are the correct type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration dictionary.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the parameters are not the correct type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.create_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">create_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#create_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.create_hparams" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>dict</em>) – Dictionary with the model requirements.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hyperparameter object in TF.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.contrib.training.HParams</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.dcg_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">dcg_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#dcg_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.dcg_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing dcg score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dcg scores.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.download_deeprec_resources">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">download_deeprec_resources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">azure_container_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remote_resource_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#download_deeprec_resources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.download_deeprec_resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Download resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>azure_container_url</strong> (<em>str</em>) – URL of Azure container.</p></li>
<li><p><strong>data_path</strong> (<em>str</em>) – Path to download the resources.</p></li>
<li><p><strong>remote_resource_name</strong> (<em>str</em>) – Name of the resource.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.flat_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">flat_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#flat_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.flat_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Flat config loaded from a yaml file to a flat dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration loaded from a yaml file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Configuration dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.hit_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">hit_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#hit_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.hit_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing hit score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>hit score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.load_dict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.load_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the vocabularies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename of user, item or category vocabulary.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A saved vocabulary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.load_yaml">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">load_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#load_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.load_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.mrr_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">mrr_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#mrr_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.mrr_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing mrr score metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mrr scores.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.ndcg_score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">ndcg_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#ndcg_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.ndcg_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing ndcg score metric at k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground-truth labels.</p></li>
<li><p><strong>y_score</strong> (<em>np.ndarray</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndcg scores.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.deeprec.deeprec_utils.prepare_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.deeprec.deeprec_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/deeprec/deeprec_utils.html#prepare_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.deeprec.deeprec_utils.prepare_hparams" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the model hyperparameters and check that all have the correct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>yaml_file</strong> (<em>str</em>) – YAML file as configuration.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hyperparameter object in TF.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.contrib.training.HParams</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-recommenders.models.fastai.fastai_utils">
<span id="fastai"></span><h2>FastAI<a class="headerlink" href="#module-recommenders.models.fastai.fastai_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.fastai.fastai_utils.cartesian_product">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.fastai.fastai_utils.</span></span><span class="sig-name descname"><span class="pre">cartesian_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arrays</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/fastai/fastai_utils.html#cartesian_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.fastai.fastai_utils.cartesian_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Cartesian product in fastai algo. This is a helper function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arrays</strong> (<em>tuple of numpy.ndarray</em>) – Input arrays</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>product</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.fastai.fastai_utils.hide_fastai_progress_bar">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.fastai.fastai_utils.</span></span><span class="sig-name descname"><span class="pre">hide_fastai_progress_bar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/fastai/fastai_utils.html#hide_fastai_progress_bar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.fastai.fastai_utils.hide_fastai_progress_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Hide fastai progress bar</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.fastai.fastai_utils.score">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.fastai.fastai_utils.</span></span><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/fastai/fastai_utils.html#score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.fastai.fastai_utils.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Score all users+items provided and reduce to top_k items per user if top_k&gt;0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>learner</strong> (<em>object</em>) – Model.</p></li>
<li><p><strong>test_df</strong> (<em>pandas.DataFrame</em>) – Test dataframe.</p></li>
<li><p><strong>user_col</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>item_col</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>prediction_col</strong> (<em>str</em>) – Prediction column name.</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – Number of top items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Result of recommendation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.geoimc.geoimc_algorithm">
<span id="geoimc"></span><h2>GeoIMC<a class="headerlink" href="#module-recommenders.models.geoimc.geoimc_algorithm" title="Permalink to this headline">¶</a></h2>
<p>Module maintaining the IMC problem.</p>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_algorithm.IMCProblem">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_algorithm.</span></span><span class="sig-name descname"><span class="pre">IMCProblem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPtr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_algorithm.html#IMCProblem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_algorithm.IMCProblem" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the IMC problem.</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataPtr</strong> (<a class="reference internal" href="#recommenders.models.geoimc.geoimc_data.DataPtr" title="recommenders.models.geoimc.geoimc_data.DataPtr"><em>DataPtr</em></a>) – An object of which contains X, Z side features and target matrix Y.</p></li>
<li><p><strong>lambda1</strong> (<em>uint</em>) – Regularizer.</p></li>
<li><p><strong>rank</strong> (<em>uint</em>) – rank of the U, B, V parametrization.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_algorithm.IMCProblem.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_algorithm.html#IMCProblem.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_algorithm.IMCProblem.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_algorithm.IMCProblem.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_algorithm.html#IMCProblem.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_algorithm.IMCProblem.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Main solver of the IMC model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_opt_time</strong> (<em>uint</em>) – Maximum time (in secs) for optimization</p></li>
<li><p><strong>max_opt_iter</strong> (<em>uint</em>) – Maximum iterations for optimization</p></li>
<li><p><strong>verbosity</strong> (<em>uint</em>) – The level of verbosity for Pymanopt logs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.geoimc.geoimc_data"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.DataPtr">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_data.</span></span><span class="sig-name descname"><span class="pre">DataPtr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#DataPtr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.DataPtr" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds data and its respective indices</p>
<p>Initialize a data pointer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>csr_matrix</em>) – The target data matrix.</p></li>
<li><p><strong>entities</strong> (<em>Iterator</em>) – An iterator (of 2 elements (ndarray)) containing</p></li>
<li><p><strong>row</strong> (<em>the features of</em>) – </p></li>
<li><p><strong>entities.</strong> (<em>col</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.DataPtr.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#DataPtr.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.DataPtr.get_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Target matrix (based on the data_indices filter)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.DataPtr.get_entity">
<span class="sig-name descname"><span class="pre">get_entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">of</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'row'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#DataPtr.get_entity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.DataPtr.get_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get entity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>of</strong> (<em>str</em>) – The entity, either ‘row’ or ‘col’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Entity matrix (based on the entity_indices filter)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_data.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class that holds necessary (minimal) information needed</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the dataset</p></li>
<li><p><strong>features_dim</strong> (<em>uint</em>) – Dimension of the features. If not 0, PCA is performed
on the features as the dimensionality reduction technique</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalize the features</p></li>
<li><p><strong>target_transform</strong> (<em>str</em>) – Transform the target values. Current options are
‘normalize’ (Normalize the values), ‘’ (Do nothing), ‘binarize’ (convert
the values using a threshold defined per dataset)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset.generate_train_test_data">
<span class="sig-name descname"><span class="pre">generate_train_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#Dataset.generate_train_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset.generate_train_test_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate train, test split. The split is performed on the row
entities. So, this essentially becomes a cold start row entity test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>csr_matrix</em>) – The entire target matrix.</p></li>
<li><p><strong>test_ratio</strong> (<em>float</em>) – Ratio of test split.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#Dataset.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the entity features</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.Dataset.reduce_dims">
<span class="sig-name descname"><span class="pre">reduce_dims</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#Dataset.reduce_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.Dataset.reduce_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the dimensionality of entity features.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.ML_100K">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_data.</span></span><span class="sig-name descname"><span class="pre">ML_100K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#ML_100K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.ML_100K" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles MovieLens-100K</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the dataset</p></li>
<li><p><strong>features_dim</strong> (<em>uint</em>) – Dimension of the features. If not 0, PCA is performed
on the features as the dimensionality reduction technique</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalize the features</p></li>
<li><p><strong>target_transform</strong> (<em>str</em>) – Transform the target values. Current options are
‘normalize’ (Normalize the values), ‘’ (Do nothing), ‘binarize’ (convert
the values using a threshold defined per dataset)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.ML_100K.df2coo">
<span class="sig-name descname"><span class="pre">df2coo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#ML_100K.df2coo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.ML_100K.df2coo" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the input dataframe into a coo matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the target matrix information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_data.ML_100K.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_data.html#ML_100K.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_data.ML_100K.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Path to the directory containing ML100K dataset</p></li>
<li><p><strong>e1_path</strong> (<em>str</em>) – Path to the file containing row (user) features of ML100K dataset</p></li>
<li><p><strong>e2_path</strong> (<em>str</em>) – Path to the file containing col (movie) features of ML100K dataset</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.geoimc.geoimc_predict"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.Inferer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_predict.</span></span><span class="sig-name descname"><span class="pre">Inferer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_predict.html#Inferer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.Inferer" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds necessary (minimal) information needed for inference</p>
<p>Initialize parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – The inference method. Currently ‘dot’
(Dot product) is supported.</p></li>
<li><p><strong>k</strong> (<em>uint</em>) – <cite>k</cite> for ‘topk’ transformation.</p></li>
<li><p><strong>transformation</strong> (<em>str</em>) – Transform the inferred values into a
different scale. Currently ‘mean’ (Binarize the values
using mean of inferred matrix as the threshold), ‘topk’
(Pick Top-K inferred values per row and assign them 1,
setting rest of them to 0), ‘’ (No transformation) are
supported.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.Inferer.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPtr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_predict.html#Inferer.infer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.Inferer.infer" title="Permalink to this definition">¶</a></dt>
<dd><p>Main inference method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataPtr</strong> (<a class="reference internal" href="#recommenders.models.geoimc.geoimc_data.DataPtr" title="recommenders.models.geoimc.geoimc_data.DataPtr"><em>DataPtr</em></a>) – An object containing the X, Z features needed for inference</p></li>
<li><p><strong>W</strong> (<em>iterable</em>) – An iterable containing the U, B, V parametrized matrices.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.PlainScalarProduct">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_predict.</span></span><span class="sig-name descname"><span class="pre">PlainScalarProduct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_predict.html#PlainScalarProduct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.PlainScalarProduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Module that implements plain scalar product
as the retrieval criterion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – numpy matrix of shape (users, features)</p></li>
<li><p><strong>Y</strong> – numpy matrix of shape (items, features)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_predict.PlainScalarProduct.sim">
<span class="sig-name descname"><span class="pre">sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_predict.html#PlainScalarProduct.sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_predict.PlainScalarProduct.sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the similarity score</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.geoimc.geoimc_utils"></span><dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_utils.length_normalize">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_utils.</span></span><span class="sig-name descname"><span class="pre">length_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_utils.html#length_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_utils.length_normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Length normalize the matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – Input matrix that needs to be normalized</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Normalized matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_utils.mean_center">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_utils.</span></span><span class="sig-name descname"><span class="pre">mean_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_utils.html#mean_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_utils.mean_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs mean centering across axis 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.ndarray</em>) – Input matrix that needs to be mean centered</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.geoimc.geoimc_utils.reduce_dims">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.geoimc.geoimc_utils.</span></span><span class="sig-name descname"><span class="pre">reduce_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/geoimc/geoimc_utils.html#reduce_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.geoimc.geoimc_utils.reduce_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce dimensionality of the data using PCA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>np.ndarray</em>) – Matrix of the form (n_sampes, n_features)</p></li>
<li><p><strong>target_dim</strong> (<em>uint</em>) – Dimension to which n_features should be reduced to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.lightfm.lightfm_utils">
<span id="lightfm"></span><h2>LightFM<a class="headerlink" href="#module-recommenders.models.lightfm.lightfm_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.compare_metric">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">compare_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#compare_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.compare_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to combine and prepare list of dataframes into tidy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_list</strong> (<em>list</em>) – List of dataframes</p></li>
<li><p><strong>metrics</strong> (<em>str</em>) – name of metric to be extracted, optional</p></li>
<li><p><strong>stage</strong> (<em>str</em>) – name of model fitting stage to be extracted, optional</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Metrics</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.model_perf_plots">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">model_perf_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#model_perf_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.model_perf_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot model performance metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe in tidy format, with [‘epoch’,’level’,’value’] columns</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matplotlib axes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.prepare_all_predictions">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_all_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#prepare_all_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.prepare_all_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to prepare all predictions for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas df</em>) – dataframe of all users, items and ratings as loaded</p></li>
<li><p><strong>uid_map</strong> (<em>dict</em>) – Keys to map internal user indices to external ids.</p></li>
<li><p><strong>iid_map</strong> (<em>dict</em>) – Keys to map internal item indices to external ids.</p></li>
<li><p><strong>interactions</strong> (<em>np.float32 coo_matrix</em>) – user-item interaction</p></li>
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>num_threads</strong> (<em>int</em>) – number of parallel computation threads</p></li>
<li><p><strong>user_features</strong> (<em>np.float32 csr_matrix</em>) – User weights over features</p></li>
<li><p><strong>item_features</strong> (<em>np.float32 csr_matrix</em>) – Item weights over features</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>all predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.prepare_test_df">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_test_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#prepare_test_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.prepare_test_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to prepare test df for evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_idx</strong> (<em>slice</em>) – slice of test indices</p></li>
<li><p><strong>uids</strong> (<em>numpy.ndarray</em>) – Array of internal user indices</p></li>
<li><p><strong>iids</strong> (<em>numpy.ndarray</em>) – Array of internal item indices</p></li>
<li><p><strong>uid_map</strong> (<em>dict</em>) – Keys to map internal user indices to external ids.</p></li>
<li><p><strong>iid_map</strong> (<em>dict</em>) – Keys to map internal item indices to external ids.</p></li>
<li><p><strong>weights</strong> (<em>numpy.float32 coo_matrix</em>) – user-item interaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>user-item selected for testing</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.similar_items">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">similar_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#similar_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.similar_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to return top N similar items
based on <a class="reference external" href="https://github.com/lyst/lightfm/issues/244#issuecomment-355305681">https://github.com/lyst/lightfm/issues/244#issuecomment-355305681</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_id</strong> (<em>int</em>) – id of item to be used as reference</p></li>
<li><p><strong>item_features</strong> (<em>scipy sparse CSR matrix</em>) – item feature matric</p></li>
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of top similar items to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>top N most similar items with score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.similar_users">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">similar_users</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#similar_users"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.similar_users" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to return top N similar users based on <a class="reference external" href="https://github.com/lyst/lightfm/issues/244#issuecomment-355305681">https://github.com/lyst/lightfm/issues/244#issuecomment-355305681</a></p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>user_id (int): id of user to be used as reference
user_features (scipy sparse CSR matrix): user feature matric
model (LightFM instance): fitted LightFM model
N (int): Number of top similar users to return</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>top N most similar users with score</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightfm.lightfm_utils.track_model_metrics">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightfm.lightfm_utils.</span></span><span class="sig-name descname"><span class="pre">track_model_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightfm/lightfm_utils.html#track_model_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightfm.lightfm_utils.track_model_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to record model’s performance at each epoch, formats the performance into tidy format,
plots the performance and outputs the performance data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>LightFM instance</em>) – fitted LightFM model</p></li>
<li><p><strong>train_interactions</strong> (<em>scipy sparse COO matrix</em>) – train interactions set</p></li>
<li><p><strong>test_interactions</strong> (<em>scipy sparse COO matrix</em>) – test interaction set</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of recommendations, optional</p></li>
<li><p><strong>no_epochs</strong> (<em>int</em>) – Number of epochs to run, optional</p></li>
<li><p><strong>no_threads</strong> (<em>int</em>) – Number of parallel threads to use, optional</p></li>
<li><p><strong>**kwargs</strong> – other keyword arguments to be passed down</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Performance traces of the fitted model</p></li>
<li><p>Fitted model</p></li>
<li><p>Side effect of the method</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame, LightFM model, matplotlib axes</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.lightgbm.lightgbm_utils">
<span id="lightgbm"></span><h2>LightGBM<a class="headerlink" href="#module-recommenders.models.lightgbm.lightgbm_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.lightgbm.lightgbm_utils.</span></span><span class="sig-name descname"><span class="pre">NumEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nume_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode all the categorical features into numerical ones by sequential label encoding, sequential count encoding,
and binary encoding. Additionally, it also filters the low-frequency categories and fills the missing values.</p>
<p>Constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cate_cols</strong> (<em>list</em>) – The columns of categorical features.</p></li>
<li><p><strong>nume_cols</strong> (<em>list</em>) – The columns of numerical features.</p></li>
<li><p><strong>label_col</strong> (<em>object</em>) – The column of Label.</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – The categories whose frequency is lower than the threshold will be filtered (be treated
as “&lt;LESS&gt;”).</p></li>
<li><p><strong>thresrate</strong> (<em>float</em>) – The (1.0 - thersrate, default 1%) lowest-frequency categories will also be filtered.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Input a training set (pandas.DataFrame) and return the converted 2 numpy.ndarray (x,y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New features and labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightgbm/lightgbm_utils.html#NumEncoder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.NumEncoder.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Input a testing / validation set (pandas.DataFrame) and return the converted 2 numpy.ndarray (x,y).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New features and labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.lightgbm.lightgbm_utils.unpackbits">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.lightgbm.lightgbm_utils.</span></span><span class="sig-name descname"><span class="pre">unpackbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/lightgbm/lightgbm_utils.html#unpackbits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.lightgbm.lightgbm_utils.unpackbits" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a decimal value numpy.ndarray into multi-binary value numpy.ndarray ([1,2]-&gt;[[0,1],[1,0]])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Decimal array.</p></li>
<li><p><strong>num_bits</strong> (<em>int</em>) – The max length of the converted binary value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.ncf.dataset">
<span id="ncf"></span><h2>NCF<a class="headerlink" href="#module-recommenders.models.ncf.dataset" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.dataset.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neg_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/dataset.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Dataset class for NCF</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>pandas.DataFrame</em>) – Training data with at least columns (col_user, col_item, col_rating).</p></li>
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – Test data with at least columns (col_user, col_item, col_rating). test can be None,
if so, we only process the training data.</p></li>
<li><p><strong>n_neg</strong> (<em>int</em>) – Number of negative samples for training set.</p></li>
<li><p><strong>n_neg_test</strong> (<em>int</em>) – Number of negative samples for test set.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – Timestamp column name.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If true, set rating &gt; 0 to rating = 1.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.negative_sampling">
<span class="sig-name descname"><span class="pre">negative_sampling</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/dataset.html#Dataset.negative_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.negative_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample n_neg negative items per positive item, this function should be called every epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.test_loader">
<span class="sig-name descname"><span class="pre">test_loader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/dataset.html#Dataset.test_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.test_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Feed leave-one-out data every user</p>
<p>Generate test batch by every positive test instance,
(eg. [1, 2, 1] is a positive user &amp; item pair in test set
([userID, itemID, rating] for this tuple). This function
returns like [[1, 2, 1], [1, 3, 0], [1,6, 0], …],
ie. following our <em>leave-one-out</em> evaluation protocol.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>userID list, itemID list, rating list.
public data loader return the userID, itemID consistent with raw data
the first (userID, itemID, rating) is the positive one</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.dataset.Dataset.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/dataset.html#Dataset.train_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.dataset.Dataset.train_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Feed train data every batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) – Ff true, train data will be shuffled.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>list</em> – A list of userID list, itemID list, and rating list. Public data loader returns the userID, itemID consistent with raw data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.ncf.ncf_singlenode"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.ncf.ncf_singlenode.</span></span><span class="sig-name descname"><span class="pre">NCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NeuMF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[16,</span> <span class="pre">8,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/ncf_singlenode.html#NCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF" title="Permalink to this definition">¶</a></dt>
<dd><p>Neural Collaborative Filtering (NCF) implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>He, Xiangnan, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. “Neural collaborative filtering.”
In Proceedings of the 26th International Conference on World Wide Web, pp. 173-182. International World Wide Web
Conferences Steering Committee, 2017. Link: <a class="reference external" href="https://www.comp.nus.edu.sg/~xiangnan/papers/ncf.pdf">https://www.comp.nus.edu.sg/~xiangnan/papers/ncf.pdf</a></p>
</dd>
</dl>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_users</strong> (<em>int</em>) – Number of users in the dataset.</p></li>
<li><p><strong>n_items</strong> (<em>int</em>) – Number of items in the dataset.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Model type.</p></li>
<li><p><strong>n_factors</strong> (<em>int</em>) – Dimension of latent space.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em>) – Number of layers for MLP.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs for training.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – Learning rate.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Whether to show the training output or not.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with training data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>NCFDataset</em>) – initilized Dataset in ./dataset.py</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neumf_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model parameters for further use.</p>
<p>GMF model –&gt; load parameters in <cite>gmf_dir</cite></p>
<p>MLP model –&gt; load parameters in <cite>mlp_dir</cite></p>
<p>NeuMF model –&gt; load parameters in <cite>neumf_dir</cite> or in <cite>gmf_dir</cite> and <cite>mlp_dir</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gmf_dir</strong> (<em>str</em>) – Directory name for GMF model.</p></li>
<li><p><strong>mlp_dir</strong> (<em>str</em>) – Directory name for MLP model.</p></li>
<li><p><strong>neumf_dir</strong> (<em>str</em>) – Directory name for neumf model.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – the concatenation hyper-parameter for gmf and mlp output layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Load parameters in this model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict function of this trained model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_input</strong> (<em>list</em><em> or </em><em>element of list</em>) – userID or userID list</p></li>
<li><p><strong>item_input</strong> (<em>list</em><em> or </em><em>element of list</em>) – itemID or itemID list</p></li>
<li><p><strong>is_list</strong> (<em>bool</em>) – if true, the input is list type
noting that list-wise type prediction is faster than element-wise’s.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of predicted rating or predicted rating score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.ncf.ncf_singlenode.NCF.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/ncf/ncf_singlenode.html#NCF.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.ncf.ncf_singlenode.NCF.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model parameters in <cite>dir_name</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dir_name</strong> (<em>str</em>) – directory name, which should be a folder name instead of file name
we will create a new directory if not existing.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.newsrec.io.mind_all_iterator">
<span id="newsrec"></span><h2>NewsRec<a class="headerlink" href="#module-recommenders.models.newsrec.io.mind_all_iterator" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.io.mind_all_iterator.</span></span><span class="sig-name descname"><span class="pre">MINDAllIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Train data loader for NAML model.
The model require a special type of data format, where each instance contains a label, impresion id, user id,
the candidate news articles and user’s clicked news article. Articles are represented by title words,
body words, verts and subverts.</p>
<p>Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.col_spliter">
<span class="sig-name descname"><span class="pre">col_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.col_spliter" title="Permalink to this definition">¶</a></dt>
<dd><p>column spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.ID_spliter">
<span class="sig-name descname"><span class="pre">ID_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.ID_spliter" title="Permalink to this definition">¶</a></dt>
<dd><p>ID spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>the samples num in one batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.title_size">
<span class="sig-name descname"><span class="pre">title_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.title_size" title="Permalink to this definition">¶</a></dt>
<dd><p>max word num in news title.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.body_size">
<span class="sig-name descname"><span class="pre">body_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.body_size" title="Permalink to this definition">¶</a></dt>
<dd><p>max word num in news body (abstract used in MIND).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.his_size">
<span class="sig-name descname"><span class="pre">his_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.his_size" title="Permalink to this definition">¶</a></dt>
<dd><p>max clicked news num in user click history.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.npratio">
<span class="sig-name descname"><span class="pre">npratio</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.npratio" title="Permalink to this definition">¶</a></dt>
<dd><p>negaive and positive ratio used in negative sampling. -1 means no need of negtive sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as head_num and head_dim are there.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – the running graph. All created placeholder will be added to this graph.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column spliter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID spliter in one line.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_behaviors">
<span class="sig-name descname"><span class="pre">init_behaviors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaviors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.init_behaviors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_behaviors" title="Permalink to this definition">¶</a></dt>
<dd><p>Init behavior logs given behaviors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>behaviors_file</strong> (<em>str</em>) – path of behaviors file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_news">
<span class="sig-name descname"><span class="pre">init_news</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.init_news"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.init_news" title="Permalink to this definition">¶</a></dt>
<dd><p>Init news information given news file, such as <cite>news_title_index</cite>, <cite>news_abstract_index</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>news_file</strong> – path of news file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed results, in the format of graph feed_dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_dict">
<span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pickled file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>file</em>) – File path</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pickle load obj</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_impression_from_file">
<span class="sig-name descname"><span class="pre">load_impression_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaivors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_impression_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_impression_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse impression data from behaivors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>behaivors_file</strong> (<em>str</em>) – A file contains several informations of behaviros.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed impression data, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_news_from_file">
<span class="sig-name descname"><span class="pre">load_news_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_news_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_news_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse user data from news file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed news feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_user_from_file">
<span class="sig-name descname"><span class="pre">load_user_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.load_user_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.load_user_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse user data from news file and behavior file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed user feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_all_iterator.html#MINDAllIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_all_iterator.MINDAllIterator.parser_one_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one string line into feature values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<em>str</em>) – a string indicating one instance.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>list</em> – Parsed results including label, impression id , user id,
candidate_title_index, clicked_title_index,
candidate_ab_index, clicked_ab_index,
candidate_vert_index, clicked_vert_index,
candidate_subvert_index, clicked_subvert_index,</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.io.mind_iterator"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.io.mind_iterator.</span></span><span class="sig-name descname"><span class="pre">MINDIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID_spliter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Train data loader for NAML model.
The model require a special type of data format, where each instance contains a label, impresion id, user id,
the candidate news articles and user’s clicked news article. Articles are represented by title words,
body words, verts and subverts.</p>
<p>Iterator will not load the whole data into memory. Instead, it loads data into memory
per mini-batch, so that large files can be used as input data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.col_spliter">
<span class="sig-name descname"><span class="pre">col_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.col_spliter" title="Permalink to this definition">¶</a></dt>
<dd><p>column spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.ID_spliter">
<span class="sig-name descname"><span class="pre">ID_spliter</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.ID_spliter" title="Permalink to this definition">¶</a></dt>
<dd><p>ID spliter in one line.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>the samples num in one batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.title_size">
<span class="sig-name descname"><span class="pre">title_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.title_size" title="Permalink to this definition">¶</a></dt>
<dd><p>max word num in news title.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.his_size">
<span class="sig-name descname"><span class="pre">his_size</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.his_size" title="Permalink to this definition">¶</a></dt>
<dd><p>max clicked news num in user click history.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.npratio">
<span class="sig-name descname"><span class="pre">npratio</span></span><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.npratio" title="Permalink to this definition">¶</a></dt>
<dd><p>negaive and positive ratio used in negative sampling. -1 means no need of negtive sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize an iterator. Create necessary placeholders for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as head_num and head_dim are there.</p></li>
<li><p><strong>npratio</strong> (<em>int</em>) – negaive and positive ratio used in negative sampling. -1 means no need of negtive sampling.</p></li>
<li><p><strong>col_spliter</strong> (<em>str</em>) – column spliter in one line.</p></li>
<li><p><strong>ID_spliter</strong> (<em>str</em>) – ID spliter in one line.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_behaviors">
<span class="sig-name descname"><span class="pre">init_behaviors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaviors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.init_behaviors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_behaviors" title="Permalink to this definition">¶</a></dt>
<dd><p>init behavior logs given behaviors file.</p>
<p>Args:
behaviors_file: path of behaviors file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_news">
<span class="sig-name descname"><span class="pre">init_news</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.init_news"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.init_news" title="Permalink to this definition">¶</a></dt>
<dd><p>init news information given news file, such as news_title_index and nid2index.
:param news_file: path of news file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_data_from_file">
<span class="sig-name descname"><span class="pre">load_data_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_data_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse data from news file and behavior file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed results, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_dict">
<span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>load pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>file</em>) – file path</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pickle loaded object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_impression_from_file">
<span class="sig-name descname"><span class="pre">load_impression_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaivors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_impression_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_impression_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse impression data from behaivors file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>behaivors_file</strong> (<em>str</em>) – A file contains several informations of behaviros.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed impression data, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_news_from_file">
<span class="sig-name descname"><span class="pre">load_news_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_news_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_news_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse user data from news file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed news feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_user_from_file">
<span class="sig-name descname"><span class="pre">load_user_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.load_user_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.load_user_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse user data from news file and behavior file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news_file</strong> (<em>str</em>) – A file contains several informations of news.</p></li>
<li><p><strong>beahaviros_file</strong> (<em>str</em>) – A file contains information of user impressions.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>object</em> – An iterator that yields parsed user feature, in the format of dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.io.mind_iterator.MINDIterator.parser_one_line">
<span class="sig-name descname"><span class="pre">parser_one_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/io/mind_iterator.html#MINDIterator.parser_one_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.io.mind_iterator.MINDIterator.parser_one_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one behavior sample into feature values.
if npratio is larger than 0, return negtive sampled result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<em>int</em>) – sample index.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>list</em> – Parsed results including label, impression id , user id,
candidate_title_index, clicked_title_index.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.models.base_model"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic class of models</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.hparams">
<span class="sig-name descname"><span class="pre">hparams</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.hparams" title="Permalink to this definition">¶</a></dt>
<dd><p>A tf.contrib.training.HParams object, hold the entire set of hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.train_iterator">
<span class="sig-name descname"><span class="pre">train_iterator</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.train_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator to load the data in training steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.test_iterator">
<span class="sig-name descname"><span class="pre">test_iterator</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.test_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator to load the data in testing steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>An optional graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Random seed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initializing the model. Create common logics which are needed by all deeprec models, such as loss function,
parameter set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – A tf.contrib.training.HParams object, hold the entire set of hyperparameters.</p></li>
<li><p><strong>iterator_creator</strong> (<em>object</em>) – An iterator to load the data.</p></li>
<li><p><strong>graph</strong> (<em>object</em>) – An optional graph.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_batch_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the data in feed_dict with current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values for evaluation. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of evaluated results, including total loss value, data loss value, predicted scores, and ground-truth labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_behaviors_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_news_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_behaviors_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_news_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_behaviors_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model with train_file. Evaluate the model on valid_file per epoch to observe the training status.
If test_news_file is not None, evaluate it too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>str</em>) – training data set.</p></li>
<li><p><strong>valid_file</strong> (<em>str</em>) – validation set.</p></li>
<li><p><strong>test_news_file</strong> (<em>str</em>) – test set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.group_labels">
<span class="sig-name descname"><span class="pre">group_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.group_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.group_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Devide labels and preds into several group according to values in group keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – ground truth label list.</p></li>
<li><p><strong>preds</strong> (<em>list</em>) – prediction score list.</p></li>
<li><p><strong>group_keys</strong> (<em>list</em>) – group key list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Keys after group.</p></li>
<li><p>Labels after group.</p></li>
<li><p>Preds after group.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.run_eval">
<span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behaviors_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.run_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the given file and returns some evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file name that will be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that contains evaluation metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.base_model.BaseModel.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_batch_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/base_model.html#BaseModel.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.base_model.BaseModel.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Go through the optimization step once with training data in feed_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sess</strong> (<em>object</em>) – The model session object.</p></li>
<li><p><strong>feed_dict</strong> (<em>dict</em>) – Feed values to train the model. This is a dictionary that maps graph elements to values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of values, including update operation, total loss, data loss, and merged summary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.models.layers"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">AttLayer2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#AttLayer2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2" title="Permalink to this definition">¶</a></dt>
<dd><p>Soft alignment attention implement.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>attention hidden dim</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialization steps for AttLayer2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em>) – attention hidden dim</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization for variables in AttLayer2
There are there variables in AttLayer2, i.e. W, b and q.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>object</em>) – shape of input tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Core implemention of soft attention</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>object</em>) – input tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted sum of input tensors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.compute_mask">
<span class="sig-name descname"><span class="pre">compute_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.compute_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Compte output mask value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>object</em>) – input tensor.</p></li>
<li><p><strong>input_mask</strong> – input mask</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>output mask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.AttLayer2.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#AttLayer2.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.AttLayer2.compute_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute shape of output tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>tuple</em>) – shape of input tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shape of output tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.ComputeMasking">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">ComputeMasking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#ComputeMasking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.ComputeMasking" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute if inputs contains zero value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True for values not equal to zero.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool tensor</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.ComputeMasking.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#ComputeMasking.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.ComputeMasking.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or list/tuple of input tensors.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.ComputeMasking.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#ComputeMasking.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.ComputeMasking.compute_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output shape of the layer.</p>
<p>If the layer has not been built, this method will call <cite>build</cite> on the
layer. This assumes that the layer will later be used with inputs that
match the input shape provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Shape tuple (tuple of integers)
or list of shape tuples (one per output tensor of the layer).
Shape tuples can include None for free dimensions,
instead of an integer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An input shape tuple.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">OverwriteMasking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking" title="Permalink to this definition">¶</a></dt>
<dd><p>Set values at spasific positions to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>list</em>) – value tensor and mask tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor after setting values to zero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the variables of the layer (optional, for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or list/tuple of input tensors.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.OverwriteMasking.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#OverwriteMasking.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.OverwriteMasking.compute_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output shape of the layer.</p>
<p>If the layer has not been built, this method will call <cite>build</cite> on the
layer. This assumes that the layer will later be used with inputs that
match the input shape provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> – Shape tuple (tuple of integers)
or list of shape tuples (one per output tensor of the layer).
Shape tuples can include None for free dimensions,
instead of an integer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An input shape tuple.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">SelfAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiheads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#SelfAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-head self attention implement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiheads</strong> (<em>int</em>) – The number of heads.</p></li>
<li><p><strong>head_dim</strong> (<em>object</em>) – Dimention of each head.</p></li>
<li><p><strong>mask_right</strong> (<em>boolean</em>) – whether to mask right words.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Weighted sum after attention.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
<p>Initialization steps for AttLayer2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiheads</strong> (<em>int</em>) – The number of heads.</p></li>
<li><p><strong>head_dim</strong> (<em>object</em>) – Dimention of each head.</p></li>
<li><p><strong>mask_right</strong> (<em>boolean</em>) – whether to mask right words.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.Mask">
<span class="sig-name descname"><span class="pre">Mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.Mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.Mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask operation used in multi-head self attention</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_len</strong> (<em>object</em>) – sequence length of inputs.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – mode of mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensors after masking.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization for variables in SelfAttention.
There are three variables in SelfAttention, i.e. WQ, WK ans WV.
WQ is used for linear transformation of query.
WK is used for linear transformation of key.
WV is used for linear transformation of value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>object</em>) – shape of input tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">QKVs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Core logic of multi-head self attention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>QKVs</strong> (<em>list</em>) – inputs of multi-head self attention i.e. qeury, key and value.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ouput tensors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.compute_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute shape of output tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>output shape tuple.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.SelfAttention.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#SelfAttention.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.SelfAttention.get_config" title="Permalink to this definition">¶</a></dt>
<dd><p>add multiheads, multiheads and mask_right into layer config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>config of SelfAttention layer.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.PersonalizedAttentivePooling">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">PersonalizedAttentivePooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/layers.html#PersonalizedAttentivePooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.layers.PersonalizedAttentivePooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Soft alignment attention implement.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.dim1">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">dim1</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.dim1" title="Permalink to this definition">¶</a></dt>
<dd><p>first dimention of value shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.dim2">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">dim2</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.dim2" title="Permalink to this definition">¶</a></dt>
<dd><p>second dimention of value shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.layers.dim3">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.layers.</span></span><span class="sig-name descname"><span class="pre">dim3</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.layers.dim3" title="Permalink to this definition">¶</a></dt>
<dd><p>shape of query</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>weighted summary of inputs value.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>object</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.models.lstur"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.lstur.</span></span><span class="sig-name descname"><span class="pre">LSTURModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/lstur.html#LSTURModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel" title="Permalink to this definition">¶</a></dt>
<dd><p>LSTUR model(Neural News Recommendation with Multi-Head Self-Attention)</p>
<p>Mingxiao An, Fangzhao Wu, Chuhan Wu, Kun Zhang, Zheng Liu and Xing Xie:
Neural News Recommendation with Long- and Short-term User Representations, ACL 2019</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel.word2vec_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.lstur.LSTURModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.lstur.LSTURModel.hparam" title="Permalink to this definition">¶</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<p>Initialization steps for LSTUR.
Compared with the BaseModel, LSTUR need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as type and gru_unit are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – LSTUR data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – LSTUR data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.models.naml"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.naml.</span></span><span class="sig-name descname"><span class="pre">NAMLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/naml.html#NAMLModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel" title="Permalink to this definition">¶</a></dt>
<dd><p>NAML model(Neural News Recommendation with Attentive Multi-View Learning)</p>
<p>Chuhan Wu, Fangzhao Wu, Mingxiao An, Jianqiang Huang, Yongfeng Huang and Xing Xie,
Neural News Recommendation with Attentive Multi-View Learning, IJCAI 2019</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel.word2vec_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.naml.NAMLModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.naml.NAMLModel.hparam" title="Permalink to this definition">¶</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<p>Initialization steps for NAML.
Compared with the BaseModel, NAML need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as filter_num are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – NAML data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – NAML data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.models.npa"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.npa.</span></span><span class="sig-name descname"><span class="pre">NPAModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/npa.html#NPAModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel" title="Permalink to this definition">¶</a></dt>
<dd><p>NPA model(Neural News Recommendation with Attentive Multi-View Learning)</p>
<p>Chuhan Wu, Fangzhao Wu, Mingxiao An, Jianqiang Huang, Yongfeng Huang and Xing Xie:
NPA: Neural News Recommendation with Personalized Attention, KDD 2019, ADS track.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel.word2vec_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.npa.NPAModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.npa.NPAModel.hparam" title="Permalink to this definition">¶</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<p>Initialization steps for MANL.
Compared with the BaseModel, NPA need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as filter_num are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – NPA data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – NPA data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.models.nrms"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.models.nrms.</span></span><span class="sig-name descname"><span class="pre">NRMSModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/models/nrms.html#NRMSModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel" title="Permalink to this definition">¶</a></dt>
<dd><p>NRMS model(Neural News Recommendation with Multi-Head Self-Attention)</p>
<p>Chuhan Wu, Fangzhao Wu, Suyu Ge, Tao Qi, Yongfeng Huang,and Xing Xie, “Neural News
Recommendation with Multi-Head Self-Attention” in Proceedings of the 2019 Conference
on Empirical Methods in Natural Language Processing and the 9th International Joint Conference
on Natural Language Processing (EMNLP-IJCNLP)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel.word2vec_embedding">
<span class="sig-name descname"><span class="pre">word2vec_embedding</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel.word2vec_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretrained word embedding matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="recommenders.models.newsrec.models.nrms.NRMSModel.hparam">
<span class="sig-name descname"><span class="pre">hparam</span></span><a class="headerlink" href="#recommenders.models.newsrec.models.nrms.NRMSModel.hparam" title="Permalink to this definition">¶</a></dt>
<dd><p>Global hyper-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<p>Initialization steps for NRMS.
Compared with the BaseModel, NRMS need word embedding.
After creating word embedding matrix, BaseModel’s __init__ method will be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>object</em>) – Global hyper-parameters. Some key setttings such as head_num and head_dim are there.</p></li>
<li><p><strong>iterator_creator_train</strong> (<em>object</em>) – NRMS data loader class for train data.</p></li>
<li><p><strong>iterator_creator_test</strong> (<em>object</em>) – NRMS data loader class for test and validation data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.newsrec.newsrec_utils"></span><dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.check_nn_config">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">check_nn_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#check_nn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.check_nn_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Check neural networks configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f_config</strong> (<em>dict</em>) – Neural network configuration.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the parameters are not correct.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.check_type">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">check_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#check_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.check_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the config parameters are the correct type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Configuration dictionary.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the parameters are not the correct type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.create_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">create_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#create_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.create_hparams" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>dict</em>) – Dictionary with the model requirements.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hyperparameter object in TF (tf.contrib.training.HParams).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.get_mind_data_set">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">get_mind_data_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#get_mind_data_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.get_mind_data_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Get MIND dataset address</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>type</strong> (<em>str</em>) – type of mind dataset, must be in [‘large’, ‘small’, ‘demo’]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data url and train valid dataset name</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.newsample">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">newsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">news</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#newsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.newsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample ratio samples from news list.
If length of news is less than ratio, pad zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>news</strong> (<em>list</em>) – input news list</p></li>
<li><p><strong>ratio</strong> (<em>int</em>) – sample number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>output of sample list.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.prepare_hparams">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">prepare_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#prepare_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.prepare_hparams" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the model hyperparameters and check that all have the correct value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>yaml_file</strong> (<em>str</em>) – YAML file as configuration.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hyperparameter object in TF (tf.contrib.training.HParams).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.newsrec.newsrec_utils.word_tokenize">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.newsrec.newsrec_utils.</span></span><span class="sig-name descname"><span class="pre">word_tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/newsrec/newsrec_utils.html#word_tokenize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.newsrec.newsrec_utils.word_tokenize" title="Permalink to this definition">¶</a></dt>
<dd><p>Split sentence into word list using regex.
:param sent: Input sentence
:type sent: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>word list</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.rbm.rbm">
<span id="rbm"></span><h2>RBM<a class="headerlink" href="#module-recommenders.models.rbm.rbm" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.rbm.rbm.</span></span><span class="sig-name descname"><span class="pre">RBM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_stdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_protocol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[50,</span> <span class="pre">70,</span> <span class="pre">80,</span> <span class="pre">90,</span> <span class="pre">100]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM" title="Permalink to this definition">¶</a></dt>
<dd><p>Restricted  Boltzmann Machine</p>
<p>Implementation of a multinomial Restricted Boltzmann Machine for collaborative filtering
in numpy/pandas/tensorflow</p>
<p>Based on the article by Ruslan Salakhutdinov, Andriy Mnih and Geoffrey Hinton
<a class="reference external" href="https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf">https://www.cs.toronto.edu/~rsalakhu/papers/rbmcf.pdf</a></p>
<p>In this implementation we use multinomial units instead of the one-hot-encoded used in
the paper.This means that the weights are rank 2 (matrices) instead of rank 3 tensors.</p>
<p>Basic mechanics:</p>
<p>1) A computational graph is created when the RBM class is instantiated;
For an item based recommender this consists of:
visible units: The number Nv of visible units equals the number of items
hidden units : hyperparameter to fix during training</p>
<ol class="arabic simple" start="2">
<li><p>Gibbs Sampling:</p></li>
</ol>
<p>2.1) for each training epoch, the visible units are first clamped on the data</p>
<p>2.2) The activation probability of the hidden units, given a linear combination of
the visibles, is evaluated P(h=1|phi_v). The latter is then used to sample the
value of the hidden units.</p>
<p>2.3) The probability P(v=l|phi_h) is evaluated, where l=1,..,r are the rates (e.g.
r=5 for the movielens dataset). In general, this is a multinomial distribution,
from which we sample the value of v.</p>
<p>2.4) This step is repeated k times, where k increases as optimization converges. It is
essential to fix to zero the original unrated items during the all learning process.</p>
<p>3) Optimization:
The free energy of the visible units given the hidden is evaluated at the beginning (F_0)
and after k steps of Bernoulli sampling (F_k). The weights and biases are updated by
minimizing the differene F_0 - F_k.</p>
<p>4) Inference:
Once the joint probability distribution P(v,h) is learned, this is used to generate ratings
for unrated items for all users</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Train/Test Mean average precision</p>
<p>Evaluates MAP over the train/test set in online mode. Note that this needs to be evaluated on
the rated items only.</p>
<p><span class="math notranslate nohighlight">\(acc = 1/m \sum_{mu=1}^{m} \sum{i=1}^Nv 1/s(i) I(v-vp = 0)_{mu,i}\)</span></p>
<p>where <cite>m = Nusers</cite>, <cite>Nv = number of items = number of visible units</cite> and <cite>s(i)</cite> is the number of non-zero elements
per row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vp</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – Inferred output (Network prediction)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accuracy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.batch_training">
<span class="sig-name descname"><span class="pre">batch_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_minibatches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.batch_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.batch_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform training over input minibatches. If <cite>self.with_metrics</cite> is False,
no online metrics are evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_minibatches</strong> (<em>scalar</em><em>, </em><em>int32</em>) – Number of training minibatches.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Training error per single epoch. If <cite>self.with_metrics</cite> is False, this is zero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.binomial_sampling">
<span class="sig-name descname"><span class="pre">binomial_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.binomial_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.binomial_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Binomial sampling of hidden units activations using a rejection method.</p>
<p>Basic mechanics:</p>
<p>1) Extract a random number from a uniform distribution (g) and compare it with
the unit’s probability (pr)</p>
<p>2) Choose 0 if pr&lt;g, 1 otherwise. It is convenient to implement this condtion using
the relu function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pr</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – Input conditional probability.</p></li>
<li><p><strong>g</strong> (<em>numpy.ndarray</em><em>, </em><em>float32</em>) – Uniform probability used for comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Float32 tensor of sampled units. The value is 1 if pr&gt;g and 0 otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.data_pipeline">
<span class="sig-name descname"><span class="pre">data_pipeline</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.data_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.data_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the data pipeline</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.display_metrics">
<span class="sig-name descname"><span class="pre">display_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rmse_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.display_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.display_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Display training/test metrics and plots the rmse error as a function
of the training epochs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Rmse_train</strong> (<em>list</em><em>, </em><em>float32</em>) – Per epoch rmse on the train set.</p></li>
<li><p><strong>precision_train</strong> (<em>float</em>) – Precision on the train set.</p></li>
<li><p><strong>precision_test</strong> (<em>float</em>) – Precision on the test set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.eval_out">
<span class="sig-name descname"><span class="pre">eval_out</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.eval_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.eval_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement multinomial sampling from a trained model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit method</p>
<p>Training in generative models takes place in two steps:</p>
<ol class="arabic simple">
<li><p>Gibbs sampling</p></li>
<li><p>Gradient evaluation and parameters update</p></li>
</ol>
<p>This estimate is later used in the weight update step by minimizing the distance between the
model and the empirical free energy. Note that while the unit’s configuration space is sampled,
the weights are determined via maximum likelihood (saddle point).</p>
<p>Main component of the algo; once instantiated, it generates the computational graph and performs
model training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xtr</strong> (<em>numpy.ndarray</em><em>, </em><em>integers</em>) – the user/affinity matrix for the train set</p></li>
<li><p><strong>xtst</strong> (<em>numpy.ndarray</em><em>, </em><em>integers</em>) – the user/affinity matrix for the test set</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>elapsed time during training</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.free_energy">
<span class="sig-name descname"><span class="pre">free_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.free_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Free energy of the visible units given the hidden units. Since the sum is over the hidden units’
states, the functional form of the visible units Free energy is the same as the one for the binary model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tf.Tensor</em>) – This can be either the sampled value of the visible units (v_k) or the input data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Free energy of the model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.generate_graph">
<span class="sig-name descname"><span class="pre">generate_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.generate_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.generate_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the different RBM modules to generate the computational graph</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.gibbs_protocol">
<span class="sig-name descname"><span class="pre">gibbs_protocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.gibbs_protocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.gibbs_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Gibbs protocol.</p>
<p>Basic mechanics:</p>
<p>If the current epoch i is in the interval specified in the training protocol,
the number of steps in Gibbs sampling (k) is incremented by one and gibbs_sampling is updated
accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – Current epoch in the loop</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.gibbs_sampling">
<span class="sig-name descname"><span class="pre">gibbs_sampling</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.gibbs_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.gibbs_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Gibbs sampling: Determines an estimate of the model configuration via sampling. In the binary
RBM we need to impose that unseen movies stay as such, i.e. the sampling phase should not modify
the elements where v=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>integer</em>) – iterator. Number of sampling steps.</p></li>
<li><p><strong>v</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – visible units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>h_k</cite>: The sampled value of the hidden unit at step k, float32.</p></li>
<li><p><cite>v_k</cite>: The sampled value of the visible unit at step k, float32.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_gpu">
<span class="sig-name descname"><span class="pre">init_gpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.init_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Config GPU memory</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_metrics">
<span class="sig-name descname"><span class="pre">init_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.init_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize metrics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_parameters">
<span class="sig-name descname"><span class="pre">init_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.init_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the parameters of the model.</p>
<p>This is a single layer model with two biases. So we have a rectangular matrix w_{ij} and
two bias vectors to initialize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Nv</strong> (<em>int</em>) – number of visible units (input layer)</p></li>
<li><p><strong>Nh</strong> (<em>int</em>) – number of hidden units (latent variables of the model)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>w</cite> of size (Nv, Nh): correlation matrix initialized by sampling from a normal distribution with zero mean and given variance init_stdv.</p></li>
<li><p><cite>bv</cite> of size (1, Nvisible): visible units’ bias, initialized to zero.</p></li>
<li><p><cite>bh</cite> of size (1, Nhidden): hidden units’ bias, initiliazed to zero.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.init_training_session">
<span class="sig-name descname"><span class="pre">init_training_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.init_training_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.init_training_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the TF session on training data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xtr</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – The user/affinity matrix for the train set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.losses" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – empirical input</p></li>
<li><p><strong>v_k</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – sampled visible units at step k</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Objective function of Contrastive divergence: the difference between the free energy clamped on the data (v) and the model Free energy (v_k).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.multinomial_distribution">
<span class="sig-name descname"><span class="pre">multinomial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.multinomial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.multinomial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Probability that unit v has value l given phi: P(v=l|phi)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<em>tf.Tensor</em>) – linear combination of values of the previous layer</p></li>
<li><p><strong>r</strong> (<em>float</em>) – rating scale, corresponding to the number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A tensor of shape (r, m, Nv): This needs to be reshaped as (m, Nv, r) in the last step to allow for faster sampling when used in the multinomial function.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.multinomial_sampling">
<span class="sig-name descname"><span class="pre">multinomial_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.multinomial_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.multinomial_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Multinomial Sampling of ratings</p>
<p>Basic mechanics:
For r classes, we sample r binomial distributions using the rejection method. This is possible
since each class is statistically independent from the other. Note that this is the same method
used in numpy’s random.multinomial() function.</p>
<p>1) extract a size r array of random numbers from a uniform distribution (g). As pr is normalized,
we need to normalize g as well.</p>
<p>2) For each user and item, compare pr with the reference distribution. Note that the latter needs
to be the same for ALL the user/item pairs in the dataset, as by assumptions they are sampled
from a common distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pr</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – A distributions of shape (m, n, r), where m is the number of examples, n the number
of features and r the number of classes. pr needs to be normalized, i.e. sum_k p(k) = 1 for all m, at fixed n.</p></li>
<li><p><strong>f</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – Normalized, uniform probability used for comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An (m,n) float32 tensor of sampled rankings from 1 to r.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.placeholder">
<span class="sig-name descname"><span class="pre">placeholder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.placeholder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.placeholder" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the placeholders for the visible units</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inferred ratings. This method is similar to recommend_k_items() with the
exceptions that it returns all the inferred ratings</p>
<p>Basic mechanics:</p>
<p>The method samples new ratings from the learned joint distribution, together with
their probabilities. The input x must have the same number of columns as the one used
for training the model, i.e. the same number of items, but it can have an arbitrary number
of rows (users).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – Input user/affinity matrix. Note that this can be a single vector, i.e.</p></li>
<li><p><strong>user.</strong> (<em>the ratings of a single</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A matrix with the inferred ratings.</p></li>
<li><p>The elapsed time for predediction.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.</p>
<p>Basic mechanics:</p>
<p>The method samples new ratings from the learned joint distribution, together with their
probabilities. The input x must have the same number of columns as the one used for training
the model (i.e. the same number of items) but it can have an arbitrary number of rows (users).</p>
<p>A recommendation score is evaluated by taking the element-wise product between the ratings and
the associated probabilities. For example, we could have the following situation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">rating</span>     <span class="n">probability</span>     <span class="n">score</span>
<span class="n">item1</span>     <span class="mi">5</span>           <span class="mf">0.5</span>          <span class="mf">2.5</span>
<span class="n">item2</span>     <span class="mi">4</span>           <span class="mf">0.8</span>          <span class="mf">3.2</span>
</pre></div>
</div>
<p>then item2 will be recommended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input user/affinity matrix. Note that this can be a single vector, i.e. the ratings</p></li>
<li><p><strong>user.</strong> (<em>of a single</em>) – </p></li>
<li><p><strong>top_k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A sparse matrix containing the top_k elements ordered by their score.</p></li>
<li><p>The time taken to recommend k items.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.rmse">
<span class="sig-name descname"><span class="pre">rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.rmse" title="Permalink to this definition">¶</a></dt>
<dd><p>Root Mean Square Error</p>
<p>Note that this needs to be evaluated on the rated items only</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vp</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – Inferred output (Network prediction)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>root mean square error.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.sample_hidden_units">
<span class="sig-name descname"><span class="pre">sample_hidden_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.sample_hidden_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.sample_hidden_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling: In RBM we use Contrastive divergence to sample the parameter space. In order to do that we need
to initialize the two conditional probabilities:</p>
<p>P(h|phi_v) –&gt; returns the probability that the i-th hidden unit is active</p>
<p>P(v|phi_h) –&gt; returns the probability that the  i-th visible unit is active</p>
<p>Sample hidden units given the visibles. This can be thought of as a Forward pass step in a FFN</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vv</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – visible units</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>phv</cite>: The activation probability of the hidden unit.</p></li>
<li><p><cite>h_</cite>: The sampled value of the hidden unit from a Bernoulli distributions having success probability <cite>phv</cite>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.sample_visible_units">
<span class="sig-name descname"><span class="pre">sample_visible_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.sample_visible_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.sample_visible_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the visible units given the hiddens. This can be thought of as a Backward pass in a FFN
(negative phase). Each visible unit can take values in [1,rating], while the zero is reserved
for missing data; as such the value of the hidden unit is sampled from a multinomial distribution.</p>
<p>Basic mechanics:</p>
<p>1) For every training example we first sample Nv Multinomial distributions. The result is of the
form [0,1,0,0,0,…,0] where the index of the 1 element corresponds to the rth rating. The index
is extracted using the argmax function and we need to add 1 at the end since array indeces starts
from 0.</p>
<p>2) Selects only those units that have been sampled. During the training phase it is important to not
use the reconstructed inputs, so we beed to enforce a zero value in the reconstructed ratings in
the same position as the original input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>h</strong> (<em>tf.Tensor</em><em>, </em><em>float32</em>) – visible units.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>pvh</cite>: The activation probability of the visible unit given the hidden.</p></li>
<li><p><cite>v_</cite>: The sampled value of the visible unit from a Multinomial distributions having success probability <cite>pvh</cite>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.Tensor, tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.time">
<span class="sig-name descname"><span class="pre">time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time a particular section of the code - call this once to set the state somewhere
in the code, then call it again to return the elapsed time since last call.
Call again to set the time and so on…</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>if timer started time in seconds since the last time time function was called</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rbm.rbm.RBM.train_test_precision">
<span class="sig-name descname"><span class="pre">train_test_precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rbm/rbm.html#RBM.train_test_precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rbm.rbm.RBM.train_test_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates precision on the train and test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xtst</strong> (<em>numpy.ndarray</em><em>, </em><em>integer32</em>) – The user/affinity matrix for the test set</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Precision on the train and test sets.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.rlrmc.RLRMCalgorithm">
<span id="rlrmc"></span><h2>RLRMC<a class="headerlink" href="#module-recommenders.models.rlrmc.RLRMCalgorithm" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.rlrmc.RLRMCalgorithm.</span></span><span class="sig-name descname"><span class="pre">RLRMCalgorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/RLRMCalgorithm.html#RLRMCalgorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>RLRMC algorithm implementation.</p>
<p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank</strong> (<em>int</em>) – rank of the final model. Should be a positive integer.</p></li>
<li><p><strong>C</strong> (<em>float</em>) – regularization parameter. Should be a positive real number.</p></li>
<li><p><strong>model_param</strong> (<em>dict</em>) – contains model parameters such as number of rows &amp; columns of the matrix as well as
the mean rating in the training dataset.</p></li>
<li><p><strong>initialize_flag</strong> (<em>str</em>) – flag to set the initialization step of the algorithm. Current options are ‘random’
(which is random initilization) and ‘svd’ (which is a singular value decomposition based initilization).</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – maximum time (in seconds), for which the algorithm is allowed to execute.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of iterations, for which the algorithm is allowed to execute.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RLRMCdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/RLRMCalgorithm.html#RLRMCalgorithm.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying fit method for RLRMC</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RLRMCdata</strong> (<a class="reference internal" href="#recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset" title="recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset"><em>RLRMCdataset</em></a>) – the RLRMCdataset object.</p></li>
<li><p><strong>verbosity</strong> (<em>int</em>) – verbosity of Pymanopt. Possible values are 0 (least verbose), 1, or 2 (most verbose).</p></li>
<li><p><strong>_evaluate</strong> (<em>bool</em>) – flag to compute the per iteration statistics in train (and validation) datasets.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm.fit_and_evaluate">
<span class="sig-name descname"><span class="pre">fit_and_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RLRMCdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/RLRMCalgorithm.html#RLRMCalgorithm.fit_and_evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm.fit_and_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Main fit and evalute method for RLRMC. In addition to fitting the model, it also computes the per
iteration statistics in train (and validation) datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RLRMCdata</strong> (<a class="reference internal" href="#recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset" title="recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset"><em>RLRMCdataset</em></a>) – the RLRMCdataset object.</p></li>
<li><p><strong>verbosity</strong> (<em>int</em>) – verbosity of Pymanopt. Possible values are 0 (least verbose), 1, or 2 (most verbose).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/RLRMCalgorithm.html#RLRMCalgorithm.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.RLRMCalgorithm.RLRMCalgorithm.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict function of this trained model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_input</strong> (<em>list</em><em> or </em><em>element of list</em>) – userID or userID list</p></li>
<li><p><strong>item_input</strong> (<em>list</em><em> or </em><em>element of list</em>) – itemID or itemID list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of predicted rating or predicted rating score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list or float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.rlrmc.RLRMCdataset"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.rlrmc.RLRMCdataset.</span></span><span class="sig-name descname"><span class="pre">RLRMCdataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/RLRMCdataset.html#RLRMCdataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.RLRMCdataset.RLRMCdataset" title="Permalink to this definition">¶</a></dt>
<dd><p>RLRMC dataset implementation. Creates sparse data structures for RLRMC algorithm.</p>
<p>Initialize parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pandas.DataFrame</strong> (<em>train</em>) – training data with at least columns (col_user, col_item, col_rating)</p></li>
<li><p><strong>validation</strong> (<em>pandas.DataFrame</em>) – validation data with at least columns (col_user, col_item, col_rating). validation can be None, if so, we only process the training data</p></li>
<li><p><strong>mean_center</strong> (<em>bool</em>) – flag to mean center the ratings in train (and validation) data</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – user column name</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – item column name</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – rating column name</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – timestamp column name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-recommenders.models.rlrmc.conjugate_gradient_ms"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.conjugate_gradient_ms.ConjugateGradientMS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.rlrmc.conjugate_gradient_ms.</span></span><span class="sig-name descname"><span class="pre">ConjugateGradientMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orth_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesearch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/conjugate_gradient_ms.html#ConjugateGradientMS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.conjugate_gradient_ms.ConjugateGradientMS" title="Permalink to this definition">¶</a></dt>
<dd><p>Module containing conjugate gradient algorithm based on
conjugategradient.m from the manopt MATLAB package.</p>
<p>Instantiate gradient solver class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta_type</strong> (<em>object</em>) – Conjugate gradient beta rule used to construct the new search direction.</p></li>
<li><p><strong>orth_value</strong> (<em>float</em>) – Parameter for Powell’s restart strategy. An infinite value disables this strategy.
See in code formula for the specific criterion used.</p></li>
<li><p><strong>linesearch</strong> (<em>-</em>) – The linesearch method to used.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.rlrmc.conjugate_gradient_ms.ConjugateGradientMS.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuselinesearch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/rlrmc/conjugate_gradient_ms.html#ConjugateGradientMS.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.rlrmc.conjugate_gradient_ms.ConjugateGradientMS.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform optimization using nonlinear conjugate gradient method with
linesearch.</p>
<p>This method first computes the gradient of obj w.r.t. arg, and then
optimizes by moving in a direction that is conjugate to all previous
search directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>problem</strong> (<em>object</em>) – Pymanopt problem setup using the Problem class, this must
have a .manifold attribute specifying the manifold to optimize
over, as well as a cost and enough information to compute
the gradient of that cost.</p></li>
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Optional parameter. Starting point on the manifold. If none
then a starting point will be randomly generated.</p></li>
<li><p><strong>reuselinesearch</strong> (<em>bool</em>) – Whether to reuse the previous linesearch object. Allows to
use information from a previous solve run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Local minimum of obj, or if algorithm terminated before convergence x will be the point at which it terminated.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.sar.sar_singlenode">
<span id="sar"></span><h2>SAR<a class="headerlink" href="#module-recommenders.models.sar.sar_singlenode" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.sar.sar_singlenode.</span></span><span class="sig-name descname"><span class="pre">SARSingleNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_prediction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jaccard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_decay_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_now</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timedecay_formula</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple Algorithm for Recommendations (SAR) implementation</p>
<p>SAR is a fast scalable adaptive algorithm for personalized recommendations based on user transaction history
and items description. The core idea behind SAR is to recommend items like those that a user already has
demonstrated an affinity to. It does this by 1) estimating the affinity of users for items, 2) estimating
similarity across items, and then 3) combining the estimates to generate a set of recommendations for a given user.</p>
<p>Initialize model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col_user</strong> (<em>str</em>) – user column name</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – item column name</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – rating column name</p></li>
<li><p><strong>col_timestamp</strong> (<em>str</em>) – timestamp column name</p></li>
<li><p><strong>col_prediction</strong> (<em>str</em>) – prediction column name</p></li>
<li><p><strong>similarity_type</strong> (<em>str</em>) – [‘cooccurrence’, ‘jaccard’, ‘lift’] option for computing item-item similarity</p></li>
<li><p><strong>time_decay_coefficient</strong> (<em>float</em>) – number of days till ratings are decayed by 1/2</p></li>
<li><p><strong>time_now</strong> (<em>int</em><em> | </em><em>None</em>) – current time for time decay calculation</p></li>
<li><p><strong>timedecay_formula</strong> (<em>bool</em>) – flag to apply time decay</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – item-item co-occurrences below this threshold will be removed</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – option for normalizing predictions to scale of original ratings</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix">
<span class="sig-name descname"><span class="pre">compute_affinity_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rating_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_affinity_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_affinity_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Affinity matrix.</p>
<p>The user-affinity matrix can be constructed by treating the users and items as
indices in a sparse matrix, and the events as the data. Here, we’re treating
the ratings as the event weights.  We convert between different sparse-matrix
formats to de-duplicate user-item pairs, otherwise they will get added up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Indexed df of users and items</p></li>
<li><p><strong>rating_col</strong> (<em>str</em>) – Name of column to use for ratings</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Affinity matrix in Compressed Sparse Row (CSR) format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sparse.csr</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_coocurrence_matrix">
<span class="sig-name descname"><span class="pre">compute_coocurrence_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_coocurrence_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_coocurrence_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Co-occurrence matrix.</p>
<p>The co-occurrence matrix is defined as <span class="math notranslate nohighlight">\(C = U^T * U\)</span></p>
<p>where U is the user_affinity matrix with 1’s as values (instead of ratings).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame of users and items</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Co-occurrence matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay">
<span class="sig-name descname"><span class="pre">compute_time_decay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.compute_time_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.compute_time_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute time decay on provided column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – DataFrame of users and items</p></li>
<li><p><strong>decay_column</strong> (<em>str</em>) – column to decay</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>with column decayed</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Main fit method for SAR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – User item rating dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk">
<span class="sig-name descname"><span class="pre">get_item_based_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_item_based_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_item_based_topk" title="Permalink to this definition">¶</a></dt>
<dd><p>Get top K similar items to provided seed items based on similarity metric defined.
This method will take a set of items and use them to recommend the most similar items to that set
based on the similarity matrix fit during training.
This allows recommendations for cold-users (unseen during training), note - the model is not updated.</p>
<p>The following options are possible based on information provided in the items input:
1. Single user or seed of items: only item column (ratings are assumed to be 1)
2. Single user or seed of items w/ ratings: item column and rating column
3. Separate users or seeds of items: item and user column (user ids are only used to separate item sets)
4. Separate users or seeds of items with ratings: item, user and rating columns provided</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>pandas.DataFrame</em>) – DataFrame with item, user (optional), and rating (optional) columns</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sorted top k recommendation items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk">
<span class="sig-name descname"><span class="pre">get_popularity_based_topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.get_popularity_based_topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.get_popularity_based_topk" title="Permalink to this definition">¶</a></dt>
<dd><p>Get top K most frequently occurring items across all users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend.</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>top k most popular items.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Output SAR scores for only the users-items pairs which are in the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test</strong> (<em>pandas.DataFrame</em>) – DataFrame that contains users and items to test</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame contains the prediction results</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Recommend top K items for all users which are in the test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – users to test</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – number of top items to recommend</p></li>
<li><p><strong>sort_top_k</strong> (<em>bool</em>) – flag to sort top k results</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove items seen in training from recommendation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>top k recommendation items for each user</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Score all items for test users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test</strong> (<em>pandas.DataFrame</em>) – user to test</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove items seen in training from recommendation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of interest of all items for the users.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.sar.sar_singlenode.SARSingleNode.set_index">
<span class="sig-name descname"><span class="pre">set_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/sar/sar_singlenode.html#SARSingleNode.set_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.sar.sar_singlenode.SARSingleNode.set_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate continuous indices for users and items to reduce memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe with user and item ids</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.surprise.surprise_utils">
<span id="surprise"></span><h2>Surprise<a class="headerlink" href="#module-recommenders.models.surprise.surprise_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.compute_ranking_predictions">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">compute_ranking_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/surprise/surprise_utils.html#compute_ranking_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.compute_ranking_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predictions of an algorithm from Surprise on all users and items in data. It can be used for computing
ranking metrics like NDCG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algo</strong> (<em>surprise.prediction_algorithms.algo_base.AlgoBase</em>) – an algorithm from Surprise</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – the data from which to get the users and items</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – name of the item column</p></li>
<li><p><strong>remove_seen</strong> (<em>bool</em>) – flag to remove (user, item) pairs seen in the training data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.predict">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usercol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prediction'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/surprise/surprise_utils.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predictions of an algorithm from Surprise on the data. Can be used for computing rating metrics like RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algo</strong> (<em>surprise.prediction_algorithms.algo_base.AlgoBase</em>) – an algorithm from Surprise</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – the data on which to predict</p></li>
<li><p><strong>usercol</strong> (<em>str</em>) – name of the user column</p></li>
<li><p><strong>itemcol</strong> (<em>str</em>) – name of the item column</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe with usercol, itemcol, predcol</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.surprise.surprise_utils.surprise_trainset_to_df">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.surprise.surprise_utils.</span></span><span class="sig-name descname"><span class="pre">surprise_trainset_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rating'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/surprise/surprise_utils.html#surprise_trainset_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.surprise.surprise_utils.surprise_trainset_to_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a <cite>surprise.Trainset</cite> object to <cite>pandas.DataFrame</cite></p>
<p>More info: <a class="reference external" href="https://surprise.readthedocs.io/en/stable/trainset.html">https://surprise.readthedocs.io/en/stable/trainset.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainset</strong> (<em>object</em>) – A surprise.Trainset object.</p></li>
<li><p><strong>col_user</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>col_item</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>col_rating</strong> (<em>str</em>) – Rating column name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with user column (str), item column (str), and rating column (float).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-recommenders.models.tfidf.tfidf_utils">
<span id="tf-idf"></span><h2>TF-IDF<a class="headerlink" href="#module-recommenders.models.tfidf.tfidf_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.tfidf.tfidf_utils.</span></span><span class="sig-name descname"><span class="pre">TfidfRecommender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenization_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scibert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender" title="Permalink to this definition">¶</a></dt>
<dd><p>Term Frequency - Inverse Document Frequency (TF-IDF) Recommender</p>
<p>This class provides content-based recommendations using TF-IDF vectorization in combination with cosine similarity.</p>
<p>Initialize model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_col</strong> (<em>str</em>) – Name of column containing item IDs.</p></li>
<li><p><strong>tokenization_method</strong> (<em>str</em>) – [‘none’,’nltk’,’bert’,’scibert’] option for tokenization method.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe">
<span class="sig-name descname"><span class="pre">clean_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_to_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cleaned_text'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.clean_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.clean_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the text within the columns of interest and return a dataframe with cleaned and combined text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Dataframe containing the text content to clean.</p></li>
<li><p><strong>cols_to_clean</strong> (<em>list of str</em>) – List of columns to clean by name (e.g., [‘abstract’,’full_text’]).</p></li>
<li><p><strong>new_col_name</strong> (<em>str</em>) – Name of the new column that will contain the cleaned text.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe with cleaned text in the new column.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors_tokenized</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit TF-IDF vectorizer to the cleaned and tokenized text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf</strong> (<em>TfidfVectorizer</em>) – sklearn.feature_extraction.text.TfidfVectorizer object defined in .tokenize_text().</p></li>
<li><p><strong>vectors_tokenized</strong> (<em>pandas.Series</em>) – Each row contains tokens for respective documents separated by spaces.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words">
<span class="sig-name descname"><span class="pre">get_stop_words</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_stop_words"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_stop_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the stop words excluded in the TF-IDF vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Frozenset of stop words used by the TF-IDF vectorizer (can be converted to list).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens">
<span class="sig-name descname"><span class="pre">get_tokens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_tokens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tokens generated by the TF-IDF vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dictionary of tokens generated by the TF-IDF vectorizer.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations">
<span class="sig-name descname"><span class="pre">get_top_k_recommendations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.get_top_k_recommendations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.get_top_k_recommendations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the top k recommendations with useful metadata for each recommendation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<em>pandas.DataFrame</em>) – Dataframe holding metadata for all public domain papers.</p></li>
<li><p><strong>query_id</strong> (<em>str</em>) – ID of item of interest.</p></li>
<li><p><strong>cols_to_keep</strong> (<em>list of str</em>) – List of columns from the metadata dataframe to include
(e.g., [‘title’,’authors’,’journal’,’publish_time’,’url’]).
By default, all columns are kept.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Set to True if you want to print the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stylized dataframe holding recommendations and associated metadata just for the item of interest (can access as normal dataframe by using df.data).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Styler</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items">
<span class="sig-name descname"><span class="pre">recommend_top_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.recommend_top_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.recommend_top_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Recommend k number of items similar to the item of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_clean</strong> (<em>pandas.DataFrame</em>) – Dataframe with cleaned text.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of recommendations to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe containing id of top k recommendations for all items.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text">
<span class="sig-name descname"><span class="pre">tokenize_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cleaned_text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/tfidf/tfidf_utils.html#TfidfRecommender.tokenize_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.tfidf.tfidf_utils.TfidfRecommender.tokenize_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Tokenize the input text.
For more details on the TfidfVectorizer, see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_clean</strong> (<em>pandas.DataFrame</em>) – Dataframe with cleaned text in the new column.</p></li>
<li><p><strong>text_col</strong> (<em>str</em>) – Name of column containing the cleaned text.</p></li>
<li><p><strong>ngram_range</strong> (<em>tuple of int</em>) – The lower and upper boundary of the range of n-values for different n-grams to be extracted.</p></li>
<li><p><strong>min_df</strong> (<em>int</em>) – When building the vocabulary ignore terms that have a document frequency strictly lower than the given threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Scikit-learn TfidfVectorizer object defined in <cite>.tokenize_text()</cite>.</p></li>
<li><p>Each row contains tokens for respective documents separated by spaces.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TfidfVectorizer, pandas.Series</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.vae.multinomial_vae">
<span id="vae"></span><h2>VAE<a class="headerlink" href="#module-recommenders.models.vae.multinomial_vae" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">AnnealingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_anneal_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used for updating the value of β during the annealing process.
When β reaches the value of anneal_cap, it stops increasing.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>float</em>) – current value of beta.</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can reach.</p></li>
<li><p><strong>total_anneal_steps</strong> (<em>int</em>) – total number of annealing steps.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the beta values per epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each batch the beta should is updated until it reaches the values of anneal cap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each epoch save the value of beta in _beta list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.AnnealingCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#AnnealingCallback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.AnnealingCallback.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a list in which the beta value will be saved at the end of each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.LossHistory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">LossHistory</span></span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#LossHistory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.LossHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used for saving the validation loss and the training loss per epoch.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.LossHistory.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#LossHistory.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the loss of training and validation set at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.LossHistory.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#LossHistory.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.LossHistory.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the lists where the loss of training and validation will be saved.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">Metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function used to calculate the NDCG&#64;k metric of validation set at the end of each epoch.
Weights of the model with the highest NDCG&#64;k value is saved.</p>
<p>Initialize the class parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – trained model for validation.</p></li>
<li><p><strong>val_tr</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set training part.</p></li>
<li><p><strong>val_te</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<a class="reference internal" href="datasets.html#recommenders.datasets.sparse.AffinityMatrix" title="recommenders.datasets.sparse.AffinityMatrix"><em>AffinityMatrix</em></a>) – the mapper for converting click matrix to dataframe.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user (optional).</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Metrics.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the NDCG&#64;k of the validation set metrics calculated
at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Metrics.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each epoch calculate NDCG&#64;k of the validation set.</p>
<p>If the model performance is improved, the model weights are saved.
Update the list of validation NDCG&#64;k by adding obtained value</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Metrics.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the list for validation NDCG&#64;k.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Metrics.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Metrics.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Metrics.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.
Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input click matrix.</p></li>
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.multinomial_vae.</span></span><span class="sig-name descname"><span class="pre">Mult_VAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Multinomial Variational Autoencoders (Multi-VAE) for Collaborative Filtering implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Citation</dt>
<dd class="field-odd"><p>Liang, Dawen, et al. “Variational autoencoders for collaborative filtering.”
Proceedings of the 2018 World Wide Web Conference. 2018.
<a class="reference external" href="https://arxiv.org/pdf/1802.05814.pdf">https://arxiv.org/pdf/1802.05814.pdf</a></p>
</dd>
</dl>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_users</strong> (<em>int</em>) – Number of unique users in the train set.</p></li>
<li><p><strong>original_dim</strong> (<em>int</em>) – Number of unique items in the train set.</p></li>
<li><p><strong>intermediate_dim</strong> (<em>int</em>) – Dimension of intermediate space.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimension of latent space.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs for training.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Whether to show the training output or not.</p></li>
<li><p><strong>drop_encoder</strong> (<em>float</em>) – Dropout percentage of the encoder.</p></li>
<li><p><strong>drop_decoder</strong> (<em>float</em>) – Dropout percentage of the decoder.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – a constant parameter β in the ELBO function,
when you are not using annealing (annealing=False)</p></li>
<li><p><strong>annealing</strong> (<em>bool</em>) – option of using annealing method for training the model (True)
or not using annealing, keeping a constant beta (False)</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can take during annealing process.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.display_metrics">
<span class="sig-name descname"><span class="pre">display_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.display_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.display_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots:
1) Loss per epoch both for validation and train set
2) NDCG&#64;k per epoch of the validation set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with the train sets and validate on the validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – the click matrix for the train set.</p></li>
<li><p><strong>x_valid</strong> (<em>numpy.ndarray</em>) – the click matrix for the validation set.</p></li>
<li><p><strong>x_val_tr</strong> (<em>numpy.ndarray</em>) – the click matrix for the validation set training part.</p></li>
<li><p><strong>x_val_te</strong> (<em>numpy.ndarray</em>) – the click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<em>object</em>) – the mapper for converting click matrix to dataframe. It can be AffinityMatrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.get_optimal_beta">
<span class="sig-name descname"><span class="pre">get_optimal_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.get_optimal_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.get_optimal_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the optimal beta.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.ndcg_per_epoch">
<span class="sig-name descname"><span class="pre">ndcg_per_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.ndcg_per_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.ndcg_per_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of NDCG&#64;k at each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.nn_batch_generator">
<span class="sig-name descname"><span class="pre">nn_batch_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.nn_batch_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.nn_batch_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for splitting dataset in batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – The click matrix for the train set, with float values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.multinomial_vae.Mult_VAE.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/multinomial_vae.html#Mult_VAE.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.multinomial_vae.Mult_VAE.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.
Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input click matrix.</p></li>
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-recommenders.models.vae.standard_vae"></span><dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">AnnealingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_anneal_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used for updating the value of β during the annealing process.
When β reaches the value of anneal_cap, it stops increasing.</p>
<p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>float</em>) – current value of beta.</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can reach.</p></li>
<li><p><strong>total_anneal_steps</strong> (<em>int</em>) – total number of annealing steps.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the beta values per epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each batch the beta should is updated until it reaches the values of anneal cap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each epoch save the value of beta in _beta list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.AnnealingCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#AnnealingCallback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.AnnealingCallback.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a list in which the beta value will be saved at the end of each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.LossHistory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">LossHistory</span></span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#LossHistory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.LossHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used for saving the validation loss and the training loss per epoch.</p>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.LossHistory.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#LossHistory.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.LossHistory.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the loss of training and validation set at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.LossHistory.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#LossHistory.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.LossHistory.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the lists where the loss of training and validation will be saved.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">Metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#Metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function used to calculate the NDCG&#64;k metric of validation set at the end of each epoch.
Weights of the model with the highest NDCG&#64;k value is saved.</p>
<p>Initialize the class parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – trained model for validation.</p></li>
<li><p><strong>val_tr</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set training part.</p></li>
<li><p><strong>val_te</strong> (<em>numpy.ndarray</em><em>, </em><em>float</em>) – the click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<a class="reference internal" href="datasets.html#recommenders.datasets.sparse.AffinityMatrix" title="recommenders.datasets.sparse.AffinityMatrix"><em>AffinityMatrix</em></a>) – the mapper for converting click matrix to dataframe.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user (optional).</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#Metrics.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the NDCG&#64;k of the validation set metrics calculated
at the end of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#Metrics.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each epoch calculate NDCG&#64;k of the validation set.
If the model performance is improved, the model weights are saved.
Update the list of validation NDCG&#64;k by adding obtained value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#Metrics.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the list for validation NDCG&#64;k.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.Metrics.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#Metrics.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.Metrics.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.
Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em><em>, </em><em>int32</em>) – input click matrix.</p></li>
<li><p><strong>k</strong> (<em>scalar</em><em>, </em><em>int32</em>) – the number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">recommenders.models.vae.standard_vae.</span></span><span class="sig-name descname"><span class="pre">StandardVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard Variational Autoencoders (VAE) for Collaborative Filtering implementation.</p>
<p>Initialize class parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_users</strong> (<em>int</em>) – Number of unique users in the train set.</p></li>
<li><p><strong>original_dim</strong> (<em>int</em>) – Number of unique items in the train set.</p></li>
<li><p><strong>intermediate_dim</strong> (<em>int</em>) – Dimension of intermediate space.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimension of latent space.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs for training.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of top k items per user.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Whether to show the training output or not.</p></li>
<li><p><strong>drop_encoder</strong> (<em>float</em>) – Dropout percentage of the encoder.</p></li>
<li><p><strong>drop_decoder</strong> (<em>float</em>) – Dropout percentage of the decoder.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – a constant parameter β in the ELBO function,
when you are not using annealing (annealing=False)</p></li>
<li><p><strong>annealing</strong> (<em>bool</em>) – option of using annealing method for training the model (True)
or not using annealing, keeping a constant beta (False)</p></li>
<li><p><strong>anneal_cap</strong> (<em>float</em>) – maximum value that beta can take during annealing process.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – Default path to save weights.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.display_metrics">
<span class="sig-name descname"><span class="pre">display_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE.display_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.display_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots:
1) Loss per epoch both for validation and train sets
2) NDCG&#64;k per epoch of the validation set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_val_te</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with the train sets and validate on the validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – The click matrix for the train set.</p></li>
<li><p><strong>x_valid</strong> (<em>numpy.ndarray</em>) – The click matrix for the validation set.</p></li>
<li><p><strong>x_val_tr</strong> (<em>numpy.ndarray</em>) – The click matrix for the validation set training part.</p></li>
<li><p><strong>x_val_te</strong> (<em>numpy.ndarray</em>) – The click matrix for the validation set testing part.</p></li>
<li><p><strong>mapper</strong> (<em>object</em>) – The mapper for converting click matrix to dataframe. It can be AffinityMatrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.get_optimal_beta">
<span class="sig-name descname"><span class="pre">get_optimal_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE.get_optimal_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.get_optimal_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the optimal beta.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.ndcg_per_epoch">
<span class="sig-name descname"><span class="pre">ndcg_per_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE.ndcg_per_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.ndcg_per_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of NDCG&#64;k at each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.nn_batch_generator">
<span class="sig-name descname"><span class="pre">nn_batch_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE.nn_batch_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.nn_batch_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for splitting dataset in batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x_train</strong> (<em>numpy.ndarray</em>) – The click matrix for the train set with float values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="recommenders.models.vae.standard_vae.StandardVAE.recommend_k_items">
<span class="sig-name descname"><span class="pre">recommend_k_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_seen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/vae/standard_vae.html#StandardVAE.recommend_k_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.vae.standard_vae.StandardVAE.recommend_k_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top-k items ordered by a relevancy score.</p>
<p>Obtained probabilities are used as recommendation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Input click matrix, with <cite>int32</cite> values.</p></li>
<li><p><strong>k</strong> (<em>scalar</em>) – The number of items to recommend.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sparse matrix containing the top_k elements ordered by their score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-recommenders.models.wide_deep.wide_deep_utils">
<span id="wide-deep"></span><h2>Wide &amp; Deep<a class="headerlink" href="#module-recommenders.models.wide_deep.wide_deep_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.wide_deep.wide_deep_utils.build_feature_columns">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.wide_deep.wide_deep_utils.</span></span><span class="sig-name descname"><span class="pre">build_feature_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'userID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'itemID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_feat_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossed_feat_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_feat_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wide_deep'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/wide_deep/wide_deep_utils.html#build_feature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.wide_deep.wide_deep_utils.build_feature_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Build wide and/or deep feature columns for TensorFlow high-level API Estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>users</strong> (<em>iterable</em>) – Distinct user ids.</p></li>
<li><p><strong>items</strong> (<em>iterable</em>) – Distinct item ids.</p></li>
<li><p><strong>user_col</strong> (<em>str</em>) – User column name.</p></li>
<li><p><strong>item_col</strong> (<em>str</em>) – Item column name.</p></li>
<li><p><strong>item_feat_col</strong> (<em>str</em>) – Item feature column name for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>crossed_feat_dim</strong> (<em>int</em>) – Crossed feature dimension for ‘wide’ or ‘wide_deep’ model.</p></li>
<li><p><strong>user_dim</strong> (<em>int</em>) – User embedding dimension for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>item_dim</strong> (<em>int</em>) – Item embedding dimension for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>item_feat_shape</strong> (<em>int</em><em> or </em><em>an iterable of integers</em>) – Item feature array shape for ‘deep’ or ‘wide_deep’ model.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Model type, either
‘wide’ for a linear model,
‘deep’ for a deep neural networks, or
‘wide_deep’ for a combination of linear model and neural networks.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>The wide feature columns</p></li>
<li><p>The deep feature columns. If only the wide model is selected, the deep column list is empty and viceversa.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="recommenders.models.wide_deep.wide_deep_utils.build_model">
<span class="sig-prename descclassname"><span class="pre">recommenders.models.wide_deep.wide_deep_utils.</span></span><span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wide_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ftrl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Adagrad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dnn_batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_every_n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/recommenders/models/wide_deep/wide_deep_utils.html#build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#recommenders.models.wide_deep.wide_deep_utils.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build wide-deep model.</p>
<p>To generate wide model, pass wide_columns only.
To generate deep model, pass deep_columns only.
To generate wide_deep model, pass both wide_columns and deep_columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_dir</strong> (<em>str</em>) – Model checkpoint directory.</p></li>
<li><p><strong>wide_columns</strong> (<em>list of tf.feature_column</em>) – Wide model feature columns.</p></li>
<li><p><strong>deep_columns</strong> (<em>list of tf.feature_column</em>) – Deep model feature columns.</p></li>
<li><p><strong>linear_optimizer</strong> (<em>str</em><em> or </em><em>tf.train.Optimizer</em>) – Wide model optimizer name or object.</p></li>
<li><p><strong>dnn_optimizer</strong> (<em>str</em><em> or </em><em>tf.train.Optimizer</em>) – Deep model optimizer name or object.</p></li>
<li><p><strong>dnn_hidden_units</strong> (<em>list of int</em>) – Deep model hidden units. E.g., [10, 10, 10] is three layers of 10 nodes each.</p></li>
<li><p><strong>dnn_dropout</strong> (<em>float</em>) – Deep model’s dropout rate.</p></li>
<li><p><strong>dnn_batch_norm</strong> (<em>bool</em>) – Deep model’s batch normalization flag.</p></li>
<li><p><strong>log_every_n_iter</strong> (<em>int</em>) – Log the training loss for every n steps.</p></li>
<li><p><strong>save_checkpoints_steps</strong> (<em>int</em>) – Model checkpoint frequency.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.estimator.Estimator</p>
</dd>
</dl>
</dd></dl>

</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./source"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>